{"version":3,"file":"leaflet-elevation.js","sources":["../node_modules/leaflet-i18n/Leaflet.i18n.js","../src/utils.js","../src/components.js","../src/chart.js","../src/marker.js","../src/summary.js","../src/options.js","../src/control.js","../src/distance.js","../src/altitude.js","../src/time.js","../src/slope.js","../src/speed.js","../src/acceleration.js","../src/index.js"],"sourcesContent":["// Following https://github.com/Leaflet/Leaflet/blob/master/PLUGIN-GUIDE.md\n(function (factory, window) {\n\n    // define an AMD module that relies on 'leaflet'\n    if (typeof define === 'function' && define.amd) {\n        define(['leaflet'], factory);\n\n        // define a Common JS module that relies on 'leaflet'\n    } else if (typeof exports === 'object') {\n        module.exports = factory(require('leaflet'));\n    }\n\n    // attach your plugin to the global 'L' variable\n    if (typeof window !== 'undefined' && window.L) {\n        factory(window.L);\n\n    }\n}(function (L) {\n    L.locales = {};\n    L.locale = null;\n    L.registerLocale = function registerLocale(code, locale) {\n        L.locales[code] = L.Util.extend({}, L.locales[code], locale);\n    };\n    L.setLocale = function setLocale(code) {\n        L.locale = code;\n    };\n    return L.i18n = L._ = function translate(string, data) {\n        if (L.locale && L.locales[L.locale] && L.locales[L.locale][string]) {\n            string = L.locales[L.locale][string];\n        }\n        try {\n            // Do not fail if some data is missing\n            // a bad translation should not break the app\n            string = L.Util.template(string, data);\n        }\n        catch (err) {/*pass*/\n        }\n\n        return string;\n    };\n}, window));\n","/**\n * Recursive deep merge objects.\n * Alternative to L.Util.setOptions(this, options).\n */\nexport function deepMerge(target, ...sources) {\n\tif (!sources.length) return target;\n\tconst source = sources.shift();\n\tif (isObject(target) && isObject(source)) {\n\t\tfor (const key in source) {\n\t\t\tif (isObject(source[key])) {\n\t\t\t\tif (!target[key]) Object.assign(target, {\n\t\t\t\t\t[key]: {}\n\t\t\t\t});\n\t\t\t\tdeepMerge(target[key], source[key]);\n\t\t\t} else {\n\t\t\t\tObject.assign(target, {\n\t\t\t\t\t[key]: source[key]\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\treturn deepMerge(target, ...sources);\n}\n\n/**\n * Wait for document load before execute function.\n */\nexport function deferFunc(f) {\n\tif (document.readyState !== 'complete') window.addEventListener(\"load\", f, { once: true });\n\telse f();\n}\n/**\n * Debounce function to limit events are being fired.\n */\nexport function debounce(func, wait, context, immediate) {\n\tvar timeout;\n\treturn function() {\n\t\tvar args = arguments;\n\t\tclearTimeout(timeout);\n\t\ttimeout  = setTimeout(function() {\n\t\t\ttimeout = null;\n\t\tif (!immediate) func.apply(context, args);\n\t\t}, wait);\n\t\tif (immediate && !timeout) func.apply(context, args);\n\t};\n}\n\nconst SEC  = 1000;\nconst MIN  = SEC * 60;\nconst HOUR = MIN * 60;\nconst DAY  = HOUR * 24;\n\n/**\n * Convert a duration time (millis) to a human readable string (%Dd %H:%M'%S\")\n */\nexport function formatTime(t) {\n\tlet d = Math.floor(t / DAY);\n\tlet h = Math.floor( (t - d * DAY) / HOUR);\n\tlet m = Math.floor( (t - d * DAY - h * HOUR) / MIN);\n\tlet s = Math.round( (t - d * DAY - h * HOUR - m * MIN) / SEC);\n\tif ( s === 60 ) { m++; s = 0; }\n\tif ( m === 60 ) { h++; m = 0; }\n\tif ( h === 24 ) { d++; h = 0; }\n\treturn (d ? d + \"d \" : '') + h.toString().padStart(2, 0) + ':' + m.toString().padStart(2, 0) + \"'\" + s.toString().padStart(2, 0) + '\"';\n}\n\n/**\n * Simple GeoJSON data loader.\n */\nexport function GeoJSONLoader(data, control) {\n\tif (typeof data === \"string\") {\n\t\tdata = JSON.parse(data);\n\t}\n\tcontrol = control || this;\n\n  let distanceMarkers = (\n\t\t\tcontrol.options.distanceMarkers === true\n\t\t\t\t? { lazy: true }\n\t\t\t\t: L.extend({ lazy: true }, control.options.distanceMarkers)\n\t);\n\n  let wptIcons = control.options.gpxOptions.marker_options.wptIcons;\n\n\tlet layer = L.geoJson(data, {\n\t\tdistanceMarkers: distanceMarkers,\n\t\tstyle: (feature) => {\n\t\t\tlet style = L.extend({}, control.options.polyline);\n\t\t\tif (control.options.theme) {\n\t\t\t\tstyle.className += ' ' + control.options.theme;\n\t\t\t}\n\t\t\treturn style;\n\t\t},\n\t\tpointToLayer: (feature, latlng) => {\n      if (!control.options.waypoints) return;\n\n\t\t\tlet prop   = feature.properties;\n\t\t\tlet desc   = prop.desc ? prop.desc : '';\n\t\t\tlet name   = prop.name ? prop.name : '';\n\t\t\tlet sym    = (prop.sym ? prop.sym : name).replace(' ', '-').replace('\"', '').replace(\"'\", '').toLowerCase();\n\n\t\t\t// generate appropriate icon symbol or retrieve it from cache\n\t\t\twptIcons[sym] = (wptIcons[sym] ? wptIcons[sym] : L.divIcon({\n\t\t\t\tclassName: 'elevation-waypoint-marker',\n\t\t\t\thtml: '<i class=\"elevation-waypoint-icon ' + sym + '\"></i>',\n\t\t\t\ticonSize: [30, 30],\n\t\t\t\ticonAnchor: [8, 30],\n\t\t\t}));\n\t\t\tlet marker = L.marker(latlng, { icon: wptIcons[sym] });\n\t\t\tif (name || desc) {\n\t\t\t\tmarker.bindPopup(\"<b>\" + name + \"</b>\" + (desc.length > 0 ? '<br>' + desc : '')).openPopup();\n\t\t\t}\n\t\t\tcontrol._registerCheckPoint({latlng: latlng, label: name}, true);\n\t\t\tcontrol.fire('waypoint_added', { point: marker, element: latlng, properties: prop });\n\t\t\treturn marker;\n\t\t},\n\t\tonEachFeature: (feature, layer) => {\n\t\t\tif (feature.geometry && feature.geometry.type == 'Point') return;\n\n\t\t\t// Standard GeoJSON\n\t\t\t// control.addData(feature, layer);  // NB uses \"_addGeoJSONData\"\n\n\t\t\t// Extended GeoJSON\n\t\t\tlayer._latlngs.forEach((point, i, data) => {\n\t\t\t\t// same properties as L.GPX layer\n\t\t\t\tpoint.meta = { time: null, ele: null, hr: null, cad: null, atemp: null, speed: null };\n\t\t\t\tif(\"alt\" in point) point.meta.ele = point.alt;\n\t\t\t\tif(feature.properties) {\n\t\t\t\t\tlet prop = feature.properties;\n\t\t\t\t\tif (\"speeds\" in prop) point.meta.speed = prop.speeds[i];\n\t\t\t\t\tif(\"coordTimes\" in prop) point.meta.time = new Date(Date.parse(prop.coordTimes[i]));\n\t\t\t\t\telse if(\"times\" in prop) point.meta.time = new Date(Date.parse(prop.times[i]));\n\t\t\t\t\telse if(\"time\" in prop) point.meta.time = new Date(Date.parse((typeof prop.time === 'object' ? prop.time[i] : prop.time)));\n\t\t\t\t\tif(\"heartRates\" in prop) point.meta.hr = parseInt(prop.heartRates[i]);\n\t\t\t\t\telse if(\"heartRate\" in prop) point.meta.hr = parseInt((typeof prop.heartRate === 'object' ? prop.heartRate[i] : prop.heartRate));\n\t\t\t\t\t// TODO: cadence, temperature\n\t\t\t\t}\n\t\t\t});\n\t\t\tcontrol.addData(layer); // NB uses \"_addGPXData\"\n\n\t\t\t// Postpone adding the distance markers (lazy: true)\n\t\t\tif(control.options.distanceMarkers && distanceMarkers.lazy) {\n\t\t\t  layer.on('add remove', (e) => {\n\t\t\t    let path = e.target;\n\t\t\t    if (L.DistanceMarkers && path instanceof L.Polyline) {\n\t\t\t\t\t\tpath[e.type + 'DistanceMarkers']();\n\t\t\t    }\n\t\t\t  });\n\t\t\t}\n\n\t\t\tcontrol.track_info = L.extend({}, control.track_info, { type: \"geojson\", name: data.name });\n\t\t},\n\t});\n\n\tL.Control.Elevation._d3LazyLoader.then(() => {\n\t\tcontrol._fireEvt(\"eledata_loaded\", { data: data, layer: layer, name: control.track_info.name, track_info: control.track_info })\n\t});\n\n\treturn layer;\n}\n\n/**\n * Check DOM element visibility.\n */\nexport function isDomVisible(elem) {\n\treturn !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);\n}\n\n/**\n * Check object type.\n */\nexport function isObject(item) {\n\treturn (item && typeof item === 'object' && !Array.isArray(item));\n}\n\n/**\n * Check DOM element viewport visibility.\n */\nexport function isVisible(elem) {\n\tif (!elem) return false;\n\n\tlet styles = window.getComputedStyle(elem);\n\n\tfunction isVisibleByStyles(elem, styles) {\n\t\treturn styles.visibility !== 'hidden' && styles.display !== 'none';\n\t}\n\n\tfunction isAboveOtherElements(elem, styles) {\n\t\tlet boundingRect = elem.getBoundingClientRect();\n\t\tlet left = boundingRect.left + 1;\n\t\tlet right = boundingRect.right - 1;\n\t\tlet top = boundingRect.top + 1;\n\t\tlet bottom = boundingRect.bottom - 1;\n\t\tlet above = true;\n\n\t\tlet pointerEvents = elem.style.pointerEvents;\n\n\t\tif (styles['pointer-events'] == 'none') elem.style.pointerEvents = 'auto';\n\n\t\tif (document.elementFromPoint(left, top) !== elem) above = false;\n\t\tif (document.elementFromPoint(right, top) !== elem) above = false;\n\n\t\t// Only for completely visible elements\n\t\t// if (document.elementFromPoint(left, bottom) !== elem) above = false;\n\t\t// if (document.elementFromPoint(right, bottom) !== elem) above = false;\n\n\t\telem.style.pointerEvents = pointerEvents;\n\n\t\treturn above;\n\t}\n\n\tif (!isVisibleByStyles(elem, styles)) return false;\n\tif (!isAboveOtherElements(elem, styles)) return false;\n\treturn true;\n}\n\n/**\n * Check JSON object type.\n */\nexport function isJSONDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"{\") == 0 || doc.indexOf(\"[\") == 0;\n\t} else {\n\t\ttry {\n\t\t\tJSON.parse(doc.toString());\n\t\t} catch (e) {\n\t\t\tif (typeof doc === \"object\" && lazy) return true;\n\t\t\tconsole.warn(e);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n}\n\n/**\n * Check XML object type.\n */\nexport function isXMLDoc(doc, lazy) {\n\tlazy = typeof lazy === \"undefined\" ? true : lazy;\n\tif (typeof doc === \"string\" && lazy) {\n\t\tdoc = doc.trim();\n\t\treturn doc.indexOf(\"<\") == 0;\n\t} else {\n\t\tlet documentElement = (doc ? doc.ownerDocument || doc : 0).documentElement;\n\t\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n\t}\n}\n\n/**\n * Async JS script download.\n */\nexport function lazyLoader(url, skip, loader) {\n\tif (skip === false) {\n\t\treturn Promise.resolve();\n\t}\n\tif (loader instanceof Promise) {\n\t\treturn loader;\n\t}\n\treturn new Promise((resolve, reject) => {\n\t\tlet tag = document.createElement(\"script\");\n\t\ttag.addEventListener('load', resolve, { once: true });\n\t\ttag.src = url;\n\t\tdocument.head.appendChild(tag);\n\t});\n}\n\n/**\n * Generate download data event.\n */\nexport function saveFile(dataURI, fileName) {\n\tlet a = create('a', '', { href: dataURI, target: '_new', download: fileName || \"\", style: \"display:none;\" });\n\tlet b = document.body;\n\tb.appendChild(a);\n\ta.click();\n\tb.removeChild(a);\n}\n\n/**\n * Wait for element visible before execute function.\n */\nexport function waitHolder(elem) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet ticking = false;\n\t\tlet scrollFn = () => {\n\t\t\tif (!ticking) {\n\t\t\t\tL.Util.requestAnimFrame(() => {\n\t\t\t\t\tif (isVisible(elem)) {\n\t\t\t\t\t\twindow.removeEventListener('scroll', scrollFn);\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t\tticking = false;\n\t\t\t\t});\n\t\t\t\tticking = true;\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('scroll', scrollFn);\n\t\tif (elem) elem.addEventListener('mouseenter', scrollFn, { once: true });\n\t\tscrollFn();\n\t});\n}\n\n/**\n * A little bit safier than L.DomUtil.addClass\n */\nexport function addClass(targetNode, className) {\n\tif (targetNode) className.split(\" \").every(s => s && L.DomUtil.addClass(targetNode, s));\n}\n\n/**\n * A little bit safier than L.DomUtil.removeClass()\n */\nexport function removeClass(targetNode, className) {\n\tif (targetNode) className.split(\" \").every(s => s && L.DomUtil.removeClass(targetNode, s));\n}\n\nexport function toggleClass(targetNode, className, conditional) {\n\treturn (conditional ? addClass : removeClass).call(null, targetNode, className)\n}\n\nexport function replaceClass(targetNode, removeClassName, addClassName) {\n  if (removeClassName) removeClass(targetNode, removeClassName);\n  if (addClassName) addClass(targetNode, addClassName);\n}\n\nexport function style(targetNode, name, value) {\n\tif (typeof value === \"undefined\") return L.DomUtil.getStyle(targetNode, name);\n\telse return targetNode.style.setProperty(name, value);\n}\n\nexport function toggleStyle(targetNode, name, value, conditional) {\n  return style(targetNode, name, conditional ? value : '');\n}\n\nexport function toggleEvent(leafletElement, eventName, handler, conditional) {\n\treturn leafletElement[conditional ? 'on' : 'off'](eventName, handler);\n}\n\n/**\n * A little bit shorter than L.DomUtil.create()\n */\nexport function create(tagName, className, attributes, parent) {\n\tlet elem = L.DomUtil.create(tagName, className || \"\");\n\tif (attributes) setAttributes(elem, attributes);\n\tif (parent) append(parent, elem);\n\treturn elem;\n}\n\n/**\n * Same as node.appendChild()\n */\nexport function append(parent, child) {\n\treturn parent.appendChild(child);\n}\n\n/**\n * Same as node.insertAdjacentElement()\n */\nexport function insert(parent, child, position) {\n\treturn parent.insertAdjacentElement(position, child);\n}\n\n/**\n * Loop for node.setAttribute()\n */\nexport function setAttributes(elem, attrs) {\n\tfor (let k in attrs) { elem.setAttribute(k, attrs[k]); }\n}\n\n/**\n * Same as node.querySelector().\n */\nexport function select(selector, context) {\n\treturn (context || document).querySelector(selector);\n}\n\n/**\n * Alias for L.DomEvent.on.\n */\nexport const on = L.DomEvent.on;\n\n/**\n * Alias for L.DomEvent.off.\n */\nexport const off = L.DomEvent.off;\n\n/**\n * Alias for L.DomUtil.hasClass.\n */\nexport const hasClass = L.DomUtil.hasClass;\n\n\nexport function randomId() {\n\treturn Math.random().toString(36).substr(2, 9);\n}\n\nexport function each(obj, fn) {\n\tfor (let i in obj) fn(obj[i], i);\n}\n","export const Colors = {\n\t'lightblue': { area: '#3366CC', alpha: 0.45, stroke: '#3366CC' },\n\t'magenta'  : { area: '#FF005E' },\n\t'yellow'   : { area: '#FF0' },\n\t'purple'   : { area: '#732C7B' },\n\t'steelblue': { area: '#4682B4' },\n\t'red'      : { area: '#F00' },\n\t'lime'     : { area: '#9CC222', line: '#566B13' }\n};\n\nexport const Area = ({\n\twidth,\n\theight,\n\txAttr,\n\tyAttr,\n\tscaleX,\n\tscaleY,\n\tinterpolation = \"curveLinear\"\n}) => {\n\treturn d3.area()\n\t\t.curve(typeof interpolation === 'string' ? d3[interpolation] : interpolation)\n\t\t.x(d => (d.xDiagCoord = scaleX(d[xAttr])))\n\t\t.y0(height)\n\t\t.y1(d => scaleY(d[yAttr]));\n};\n\nexport const Path = ({\n\tname,\n\tcolor,\n\tstrokeColor,\n\tstrokeOpacity,\n\tfillOpacity,\n}) => {\n\tlet path = d3.create('svg:path')\n\n\tif (name) path.classed(name, true);\n\n\tpath.style(\"pointer-events\", \"none\");\n\n\tpath\n\t.attr(\"fill\", color || '#3366CC')\n\t.attr(\"stroke\", strokeColor || '#000')\n\t.attr(\"stroke-opacity\", strokeOpacity || '1')\n\t.attr(\"fill-opacity\", fillOpacity || '0.8');\n\n\treturn path;\n};\n\nexport const Axis = ({\n\ttype = \"axis\",\n\ttickSize = 6,\n\ttickPadding = 3,\n\tposition,\n\theight,\n\twidth,\n\taxis,\n\tscale,\n\tticks,\n\ttickFormat,\n\tlabel,\n\tlabelX,\n\tlabelY,\n\tname = \"\",\n\tonAxisMount,\n}) => {\n\treturn g => {\n\t\tlet [w, h] = [0, 0];\n\t\tif (position == \"bottom\") h = height;\n\t\tif (position == \"right\")  w = width;\n\n\t\tif (axis == \"x\" && type == \"grid\") {\n\t\t\ttickSize = -height;\n\t\t} else if (axis == \"y\" && type == \"grid\") {\n\t\t\ttickSize = -width;\n\t\t}\n\n\t\tlet axisScale = d3[\"axis\" + position.replace(/\\b\\w/g, l => l.toUpperCase())]()\n\t\t\t.scale(scale)\n\t\t\t.ticks(ticks)\n\t\t\t.tickPadding(tickPadding)\n\t\t\t.tickSize(tickSize)\n\t\t\t.tickFormat(tickFormat);\n\n\t\tlet axisGroup = g.append(\"g\")\n\t\t\t.attr(\"class\", [axis, type, position, name].join(\" \"))\n\t\t\t.attr(\"transform\", \"translate(\" + w + \",\" + h + \")\")\n\t\t\t.call(axisScale);\n\n\t\tif (label) {\n\t\t\taxisGroup.append(\"svg:text\")\n\t\t\t\t.attr(\"x\", labelX)\n\t\t\t\t.attr(\"y\", labelY)\n\t\t\t\t.text(label);\n\t\t}\n\n\t\tif (onAxisMount) {\n\t\t\taxisGroup.call(onAxisMount);\n\t\t}\n\n\t\treturn axisGroup;\n\t};\n};\n\nexport const Grid = (props) => {\n\tprops.type = \"grid\";\n\treturn Axis(props);\n};\n\nexport const HeightFocusLine = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlength = 0,\n}) => {\n\treturn line => line\n\t\t.attr(\"class\", theme + \" height-focus line\")\n\t\t.attr(\"x1\", xCoord)\n\t\t.attr(\"x2\", xCoord)\n\t\t.attr(\"y1\", yCoord)\n\t\t.attr(\"y2\", length);\n};\n\nexport const HeightFocusLabel = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n\tlabel,\n}) => {\n\treturn text => {\n\t\ttext\n\t\t\t.attr(\"class\", theme + \" height-focus-label\")\n\t\t\t.style(\"pointer-events\", \"none\")\n\t\t\t.attr(\"x\", xCoord + 5)\n\t\t\t.attr(\"y\", yCoord);\n\n\t\tlet y = text.select(\".height-focus-y\");\n\t\tif (!y.node()) y = text.append(\"svg:tspan\");\n\n\t\ty\n\t\t\t.attr(\"class\", \"height-focus-y\")\n\t\t\t.text(label);\n\n\t\ttext.selectAll('tspan').attr(\"x\", xCoord + 5);\n\n\t\treturn text;\n\t};\n};\n\nexport const HeightFocusMarker = ({\n\ttheme,\n\txCoord = 0,\n\tyCoord = 0,\n}) => {\n\treturn circle => circle\n\t\t.attr(\"class\", theme + \" height-focus circle-lower\")\n\t\t.attr(\"transform\", \"translate(\" + xCoord + \",\" + yCoord + \")\")\n\t\t.attr(\"r\", 6)\n\t\t.attr(\"cx\", 0)\n\t\t.attr(\"cy\", 0);\n};\n\nexport const LegendItem = ({\n\tname,\n  label,\n\twidth,\n\theight,\n\tmargins = {},\n\tcolor,\n\tpath\n}) => {\n\treturn g => {\n\t\tg\n\t\t\t.attr(\"class\", \"legend-item legend-\" + name.toLowerCase())\n\t\t\t.attr(\"data-name\", name);\n\n\t\tconst svg = d3.select(g.node().ownerSVGElement || g);\n\n\t\tg.on('click.legend', () => svg.dispatch(\"legend_clicked\", {\n\t\t\tdetail: {\n\t\t\t\tpath: path.node(),\n\t\t\t\tname: name,\n\t\t\t\tlegend: g.node(),\n\t\t\t\tenabled: !path.classed('leaflet-hidden'),\n\t\t\t}\n\t\t}));\n\n\t\tg.append(\"svg:rect\")\n\t\t\t.attr(\"x\", (width / 2) - 50)\n\t\t\t.attr(\"y\", height + margins.bottom / 2)\n\t\t\t.attr(\"width\", 50)\n\t\t\t.attr(\"height\", 10)\n\t\t\t.attr(\"fill\", color)\n\t\t\t.attr(\"stroke\", \"#000\")\n\t\t\t.attr(\"stroke-opacity\", \"0.5\")\n\t\t\t.attr(\"fill-opacity\", \"0.25\");\n\n\t\tg.append('svg:text')\n\t\t\t.text(L._(label || name))\n\t\t\t.attr(\"x\", (width / 2) + 5)\n\t\t\t.attr(\"font-size\", 10)\n\t\t\t.style(\"text-decoration-thickness\", \"2px\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr('y', height + margins.bottom / 2)\n\t\t\t.attr('dy', \"0.75em\");\n\n\t\treturn g;\n\t}\n};\n\nexport const MouseFocusLine = ({\n\txCoord = 0,\n\theight,\n}) => {\n\treturn line => line\n\t\t.attr('class', 'mouse-focus-line')\n\t\t.attr('x2', xCoord)\n\t\t.attr('y2', 0)\n\t\t.attr('x1', xCoord)\n\t\t.attr('y1', height);\n};\n\nexport const MouseFocusLabel = ({\n\txCoord,\n\tyCoord,\n\tlabelX = \"\",\n\tlabelY = \"\",\n\twidth,\n}) => {\n\treturn g => {\n\n\t\tg.attr('class', 'mouse-focus-label');\n\n\t\tlet rect = g.select(\".mouse-focus-label-rect\");\n\t\tlet text = g.select(\".mouse-focus-label-text\");\n\t\tlet y    = text.select(\".mouse-focus-label-y\");\n\t\tlet x    = text.select(\".mouse-focus-label-x\");\n\n\t\tif (!rect.node()) rect = g.append(\"svg:rect\");\n\t\tif (!text.node()) text = g.append(\"svg:text\");\n\t\tif (!y.node())    y    = text.append(\"svg:tspan\");\n\t\tif (!x.node())    x    = text.append(\"svg:tspan\");\n\n\t\ty.text(labelY);\n\t\tx.text(labelX);\n\n\t\t// Sets focus-label-text position to the left / right of the mouse-focus-line\n\t\tlet xAlign = 0;\n\t\tlet yAlign = 0;\n\t\tlet bbox   = { width: 0, height: 0 };\n\t\ttry { bbox = text.node().getBBox(); } catch (e) { return g; }\n\n\t\tif (xCoord) xAlign = xCoord + (xCoord < width / 2 ? 10 : -bbox.width - 10);\n\t\tif (yCoord) yAlign = Math.max(yCoord - bbox.height, L.Browser.webkit ? 0 : -Infinity);\n\n\t\trect\n\t\t\t.attr(\"class\", \"mouse-focus-label-rect\")\n\t\t\t.attr(\"x\", xAlign - 5)\n\t\t\t.attr(\"y\", yAlign - 5)\n\t\t\t.attr(\"width\", bbox.width + 10)\n\t\t\t.attr(\"height\", bbox.height + 10)\n\t\t\t.attr(\"rx\", 3)\n\t\t\t.attr(\"ry\", 3);\n\t\ttext\n\t\t\t.attr(\"class\", \"mouse-focus-label-text\")\n\t\t\t.style(\"font-weight\", \"700\")\n\t\t\t.attr(\"y\", yAlign);\n\t\ty\n\t\t\t.attr(\"class\", \"mouse-focus-label-y\")\n\t\t\t.attr(\"dy\", \"1em\");\n\t\tx\n\t\t\t.attr(\"class\", \"mouse-focus-label-x\")\n\t\t\t.attr(\"dy\", \"2em\");\n\n\t\ttext.selectAll('tspan').attr(\"x\", xAlign);\n\n\t\treturn g;\n\t};\n};\n\nexport const Ruler = ({\n\theight,\n\twidth,\n}) => {\n\treturn g => {\n\n\t\tg.data([{\n\t\t\t\t\"x\": 0,\n\t\t\t\t\"y\": height,\n\t\t\t}])\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\");\n\n\t\tlet rect   = g.selectAll('.horizontal-drag-rect')\n\t\t\t.data([{ w: width }]);\n\n\t\tlet line   = g.selectAll('.horizontal-drag-line')\n\t\t\t.data([{ w: width }]);\n\n\t\tlet label  = g.selectAll('.horizontal-drag-label')\n\t\t\t.data([{ w: width - 8 }]);\n\n\t\tlet symbol = g.selectAll('.horizontal-drag-symbol')\n\t\t\t.data([{\n\t\t\t\t\"type\": d3.symbolTriangle,\n\t\t\t\t\"x\": width + 7,\n\t\t\t\t\"y\": 0,\n\t\t\t\t\"angle\": -90,\n\t\t\t\t\"size\": 50\n\t\t\t}]);\n\n\t\trect.exit().remove();\n\t\tline.exit().remove();\n\t\tlabel.exit().remove();\n\t\tsymbol.exit().remove();\n\n\t\trect.enter()\n\t\t\t.append(\"svg:rect\")\n\t\t\t.attr(\"class\", \"horizontal-drag-rect\")\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"y\", -8)\n\t\t\t.attr(\"height\", 8)\n\t\t\t.attr('fill', 'none')\n\t\t\t.attr('pointer-events', 'all')\n\t\t\t.merge(rect)\n\t\t\t.attr(\"width\", d => d.w);\n\n\t\tline.enter()\n\t\t\t.append(\"svg:line\")\n\t\t\t.attr(\"class\", \"horizontal-drag-line\")\n\t\t\t.attr(\"x1\", 0)\n\t\t\t.merge(line)\n\t\t\t.attr(\"x2\", d => d.w);\n\n\t\tlabel.enter()\n\t\t\t.append(\"svg:text\")\n\t\t\t.attr(\"class\", \"horizontal-drag-label\")\n\t\t\t.attr(\"text-anchor\", \"end\")\n\t\t\t.attr(\"y\", -8)\n\t\t\t.merge(label)\n\t\t\t.attr(\"x\", d => d.w)\n\n\t\tsymbol\n\t\t\t.enter()\n\t\t\t.append(\"svg:path\")\n\t\t\t.attr(\"class\", \"horizontal-drag-symbol\")\n\t\t\t.merge(symbol)\n\t\t\t.attr(\"d\",\n\t\t\t\td3.symbol()\n\t\t\t\t.type(d => d.type)\n\t\t\t\t.size(d => d.size)\n\t\t\t)\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \") rotate(\" + d.angle + \")\");\n\n\t\treturn g;\n\t}\n};\n\nexport const Domain = ({\n\tmin,\n\tmax,\n\tattr,\n\tname,\n\tforceBounds,\n\tscale\n}) => function(data) {\n\tattr = attr || name;\n\tif (scale && scale.attr) attr = scale.attr;\n\tlet domain = data && data.length ? d3.extent(data, d => d[attr]) : [0, 1];\n\tif (typeof min !== \"undefined\" && (min < domain[0] || forceBounds)) {\n\t\tdomain[0] = min;\n\t}\n\tif (typeof max !== \"undefined\" && (max > domain[1] || forceBounds)) {\n\t\tdomain[1] = max;\n\t}\n\treturn domain;\n};\n\nexport const Range = ({\n\taxis\n}) => function(width, height) {\n\tif (axis == 'x')      return [0, width];\n\telse if (axis == 'y') return [height, 0];\n};\n\nexport const Scale = ({\n\tdata,\n\tattr,\n\tmin,\n\tmax,\n\tforceBounds,\n\trange,\n}) => {\n\treturn d3.scaleLinear()\n\t\t.range(range)\n\t\t.domain(Domain({min, max, attr, forceBounds})(data));\n};\n\nexport const Bisect = ({\n\tdata = [0, 1],\n\tscale,\n\tx,\n\tattr\n}) => {\n\treturn d3\n\t\t.bisector(d => d[attr])\n\t\t.left(data, scale.invert(x));\n};\n\nexport const Chart = ({\n\twidth,\n\theight,\n\tmargins = {},\n\truler,\n}) => {\n\n\tconst _width   = width - margins.left - margins.right;\n\tconst _height  = height - margins.top - margins.bottom;\n\n\t// SVG Container\n\tconst svg   = d3.create(\"svg:svg\").attr(\"class\", \"background\");\n\n\t// SVG Groups\n\tconst g     = svg.append(\"g\");\n\tconst panes = {\n\t\tgrid   : g.append(\"g\").attr(\"class\", \"grid\"),\n\t\tarea   : g.append('g').attr(\"class\", \"area\"),\n\t\tpoint  : g.append('g').attr(\"class\", \"point\"),\n\t\taxis   : g.append('g').attr(\"class\", \"axis\"),\n\t\tbrush  : g.append(\"g\").attr(\"class\", \"brush\"),\n\t\ttooltip: g.append(\"g\").attr(\"class\", \"tooltip\").attr('display', 'none'),\n\t\truler  : g.append('g').attr('class', 'ruler'),\n\t\tlegend : g.append('g').attr(\"class\", \"legend\"),\n\t};\n\n\t// SVG Paths\n\tconst clipPath      = panes.area.append(\"svg:clipPath\").attr(\"id\", 'elevation-clipper');\n\tconst clipRect      = clipPath.append(\"svg:rect\");\n\n\t// Canvas Paths\n\tconst foreignObject = panes.area.append('svg:foreignObject');\n\tconst canvas        = foreignObject.append('xhtml:canvas').attr('class', 'canvas-plot');\n\tconst context       = canvas.node().getContext('2d');\n\n\t// Mouse Focus\n\tconst dragG         = panes.ruler;\n\tconst focusG        = panes.tooltip;\n\tconst brushG        = panes.brush;\n\n\tfocusG.append('svg:line')\n\t\t.call(\n\t\t\tMouseFocusLine({\n\t\t\t\txCoord: 0,\n\t\t\t\theight: _height\n\t\t\t})\n\t\t);\n\n\tfocusG.append(\"g\")\n\t\t.call(\n\t\t\tMouseFocusLabel({\n\t\t\t\txCoord: 0,\n\t\t\t\tyCoord: 0,\n\t\t\t\theight: _height,\n\t\t\t\twidth : _width,\n\t\t\t\tlabelX: \"\",\n\t\t\t\tlabelY: \"\",\n\t\t\t})\n\t\t);\n\n\n\t// Add the brushing\n\tlet brush           = d3.brushX().on('start.cursor end.cursor brush.cursor', () => brushG.select(\".overlay\").attr('cursor', null));\n\n\t// Scales\n\tconst scale         = (opts) => ({ x: Scale(opts.x), y: Scale(opts.y)});\n\n\tlet utils = {\n\t\tclipPath,\n\t\tcanvas,\n\t\tcontext,\n\t\tdragG,\n\t\tfocusG,\n\t\tbrush,\n\t};\n\n\tlet chart = {\n\t\tsvg,\n\t\tg,\n\t\tpanes,\n\t\tutils,\n\t\tscale,\n\t};\n\n\t// Resize\n\tchart._resize  = ({\n\t\twidth,\n\t\theight,\n\t\tmargins = {},\n\t\truler,\n\t}) => {\n\n\t\tconst _width   = width - margins.left - margins.right;\n\t\tconst _height  = height - margins.top - margins.bottom;\n\n\t\tsvg.attr(\"viewBox\", `0 0 ${width} ${height}`)\n\t\t\t.attr(\"width\", width)\n\t\t\t.attr(\"height\", height);\n\n\t\tg.attr(\"transform\", \"translate(\" + margins.left + \",\" + margins.top + \")\");\n\n\t\tclipRect\n\t\t\t.attr(\"x\", 0)\n\t\t\t.attr(\"y\", 0)\n\t\t\t.attr(\"width\", _width)\n\t\t\t.attr(\"height\", _height);\n\n\t\tforeignObject\n\t\t\t.attr('width', _width)\n\t\t\t.attr('height', _height);\n\n\t\tcanvas\n\t\t\t.attr('width', _width)\n\t\t\t.attr('height', _height);\n\n\t\tif (ruler) {\n\t\t\tdragG    .call(Ruler({ height: _height, width: _width }));\n\t\t}\n\n\t\tbrushG.call(brush.extent( [ [0,0], [_width, _height] ] ));\n\t\tbrushG.select(\".overlay\").attr('cursor', null);\n\n\t\tchart._width  = _width;\n\t\tchart._height = _height;\n\n\t\tchart.svg.dispatch('resize', { detail: { width: _width, height: _height } } );\n\n\t};\n\n\tchart.pane = (name) => {\n\t\tif (!panes[name]) {\n\t\t\tpanes[name] = g.append('g').attr(\"class\", name);\n\t\t}\n\t\treturn panes[name];\n\t}\n\n\tchart.get = (name) => utils[name];\n\n\tchart._resize({ width, height, margins});\n\n\treturn chart;\n};\n","import 'leaflet-i18n';\nimport * as _  from './utils';\nimport * as D3 from './components';\n\nexport var Chart = L.Class.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\tinitialize: function(opts, control) {\n\t\tthis.options       = opts;\n\t\tthis.control       = control;\n\n\t\tthis._data         = [];\n\n\t\t// cache registered components\n\t\tthis._props        = {\n\t\t\tscales     : {},\n\t\t\tpaths      : {},\n\t\t\tareas      : {},\n\t\t\tgrids      : {},\n\t\t\taxes       : {},\n\t\t\tlegendItems: {},\n\t\t\tfocusLabels: {},\n\t\t};\n\n\t\tthis._scales       = {};\n\t\tthis._domains      = {};\n\t\tthis._ranges       = {};\n\t\tthis._paths        = {};\n\n\t\tthis._brushEnabled = opts.dragging;\n\t\tthis._zoomEnabled  = opts.zooming;\n\n\t\tif (opts.imperial) {\n\t\t\tthis._xLabel  = \"mi\";\n\t\t\tthis._yLabel  = \"ft\";\n\t\t} else {\n\t\t\tthis._xLabel  = opts.xLabel;\n\t\t\tthis._yLabel  = opts.yLabel;\n\t\t}\n\n\t\tlet chart       = this._chart = D3.Chart(opts);\n\n\t\t// SVG Container\n\t\tlet svg         = this._container = chart.svg;\n\n\t\t// Panes\n\t\tthis._grid      = chart.pane('grid');\n\t\tthis._area      = chart.pane('area');\n\t\tthis._point     = chart.pane('point');\n\t\tthis._axis      = chart.pane('axis');\n\t\tthis._legend    = chart.pane('legend');\n\n\t\t// Scales\n\t\tthis._initScale();\n\n\t\t// Helpers\n\t\tthis._clipPath  = chart.get('clipPath');\n\t\tthis._canvas    = chart.get('canvas');\n\t\tthis._context   = chart.get('context');\n\t\tthis._dragG     = chart.get('dragG');\n\t\tthis._focusG    = chart.get('focusG');\n\t\tthis._brush     = chart.get('brush');\n\n\t\t// Tooltip\n\t\tthis._focusline  = this._focusG.select('.mouse-focus-line');\n\t\tthis._focuslabel = this._focusG.select('.mouse-focus-label');\n\n\t\tthis._zoom = d3.zoom();\n\t\tthis._drag = d3.drag();\n\n\t\t// Interactions\n\t\tthis._initInteractions();\n\n\t\t// svg.on('resize', (e)=>console.log(e.detail));\n\n\t},\n\n\tupdate: function(props) {\n\t\tif (props) {\n\t\t\tif (props.data) this._data = props.data;\n\t\t\tif (props.options) this.options = props.options;\n\t\t}\n\n\t\tthis._updateScale();\n\t\tthis._updateArea();\n\t\tthis._updateAxis();\n\t\tthis._updateLegend();\n\t\tthis._updateClipper();\n\n\t\treturn this;\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._container.node());\n\t},\n\n\tclear: function() {\n\t\tthis._resetDrag();\n\t\tthis._area.selectAll('path').attr(\"d\", \"M0 0\");\n\t\tthis._context.clearRect(0, 0, this._width(), this._height());\n\t\tif (this._path) {\n\t\t\t// this._x.domain([0, 1]);\n\t\t\t// this._y.domain([0, 1]);\n\t\t}\n\t},\n\n\t_drawPath: function(name) {\n\t\tlet opts   = this.options;\n\t\tlet ctx    = this._context;\n\n\t\tlet path   = this._paths[name];\n\t\tlet area   = this._props.areas[name];\n\t\tlet node   = path.node();\n\t\tlet scaleX = this._scales[area.scaleX];\n\t\tlet scaleY = this._scales[area.scaleY];\n\n\t\tarea = L.extend({}, area, {\n\t\t\twidth        : this._width(),\n\t\t\theight       : this._height(),\n\t\t\tscaleX       : scaleX,\n\t\t\tscaleY       : scaleY\n\t\t});\n\n\t\tif (!scaleY || !scaleY) {\n\t\t\treturn console.warn('Unable to render path:' + name);\n\t\t}\n\n\t\tpath.datum(this._data).attr(\"d\", D3.Area(area));\n\n\t\tif (path.classed('leaflet-hidden')) return;\n\n\t\tif (opts.preferCanvas) {\n\t\t\tpath.classed('canvas-path', true);\n\n\t\t\tctx.beginPath();\n\t\t\tctx.moveTo(0, 0);\n\t\t\tlet p = new Path2D(path.attr('d'));\n\n\t\t\tctx.strokeStyle = path.attr('stroke');\n\t\t\tctx.fillStyle   = path.attr('fill');\n\t\t\tctx.lineWidth   = 1.25;\n\t\t\tctx.globalCompositeOperation = 'source-over';\n\n\t\t\t// stroke opacity\n\t\t\tctx.globalAlpha = path.attr('stroke-opacity') || 0.3;\n\t\t\tctx.stroke(p);\n\n\t\t\t// fill opacity\n\t\t\tctx.globalAlpha = path.attr('fill-opacity')   || 0.45;\n\t\t\tctx.fill(p);\n\n\t\t\tctx.globalAlpha = 1;\n\n\t\t\tctx.closePath();\n\t\t} else {\n\t\t\tthis._area.append(() => node);\n\t\t}\n\t},\n\n\t_hasActiveLayers: function() {\n\t\tconst paths = this._paths;\n\t\tfor (var i in paths) {\n\t\t\tif (!paths[i].classed('leaflet-hidden')) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * Initialize \"d3-brush\".\n\t */\n\t_initBrush: function(e) {\n\t\tconst brush   = (e) => {\n\t\t\tlet extent  = e.selection;\n\t\t\tif (extent) {\n\t\t\t\tlet start = this._findIndexForXCoord(extent[0]);\n\t\t\t\tlet end   = this._findIndexForXCoord(extent[1]);\n\t\t\t\tthis.fire('dragged', { dragstart: this._data[start], dragend: this._data[end] });\n\t\t\t}\n\t\t}\n\n\t\tconst focus   = (e) => {\n\t\t\tif (e.type == 'brush' && !e.sourceEvent) return;\n\t\t\tlet rect    = this._chart.panes.brush.select('.overlay').node();\n\t\t\tlet coords  = d3.pointers(e, rect)[0];\n\t\t\tlet xCoord  = coords[0];\n\t\t\tlet item    = this._data[this._findIndexForXCoord(xCoord)];\n\n\t\t\tthis.fire(\"mouse_move\", { item: item, xCoord: xCoord });\n\t\t};\n\n\t\tthis._brush\n\t\t\t.filter((e) => this._brushEnabled && !e.shiftKey && !e.button)\n\t\t\t.on(\"end.update\", brush)\n\t\t\t.on(\"brush.update\", focus);\n\n\t\tthis._chart.panes.brush\n\t\t\t.on(\"mouseenter.focus touchstart.focus\", this.fire.bind(this, \"mouse_enter\"))\n\t\t\t.on(\"mouseout.focus touchend.focus\",     this.fire.bind(this, \"mouse_out\")  )\n\t\t\t.on(\"mousemove.focus touchmove.focus\",   focus                              );\n\n\t},\n\n\t/**\n\t * Initialize \"d3-zoom\"\n\t */\n\t_initClipper: function() {\n\t\tlet svg       = this._container;\n\t\tlet margin    = this.options.margins;\n\n\t\tconst zoom    = this._zoom;\n\n\t\tconst onStart = (e) => {\n\t\t\tif (e.sourceEvent && e.sourceEvent.type == \"mousedown\") svg.style('cursor', 'grabbing');\n\t\t\tif (e.transform.k == 1 && e.transform.x == 0) {\n\t\t\t\tthis._container.classed('zoomed', true);\n\t\t\t}\n\t\t\tthis.zooming = true;\n\t\t};\n\n\t\tconst onEnd  = (e) => {\n\t\t\tif (e.transform.k ==1 && e.transform.x == 0){\n\t\t\t\tthis._container.classed('zoomed', false);\n\t\t\t}\n\t\t\tthis.zooming = false;\n\t\t\tsvg.style('cursor', '');\n\t\t};\n\n\t\tconst onZoom = (e) => {\n\t\t\t// TODO: find a faster way to redraw the chart.\n\t\t\tthis.zooming = false;\n\t\t\tthis._updateScale(); // hacky way for restoring x scale when zooming out\n\t\t\tthis.zooming = true;\n\t\t\tthis._scales.distance = this._x = e.transform.rescaleX(this._x); // calculate x scale at zoom level\n\t\t\tthis._resetDrag();\n\t\t\tif (e.sourceEvent && e.sourceEvent.type == \"mousemove\") {\n\t\t\t\tthis._hideDiagramIndicator();\n\t\t\t}\n\t\t\tthis.fire('zoom');\n\t\t};\n\n\t\tzoom\n\t\t\t.scaleExtent([1, 10])\n\t\t\t.extent([\n\t\t\t\t[margin.left, 0],\n\t\t\t\t[this._width() - margin.right, this._height()]\n\t\t\t])\n\t\t\t.translateExtent([\n\t\t\t\t[margin.left, -Infinity],\n\t\t\t\t[this._width() - margin.right, Infinity]\n\t\t\t])\n\t\t\t.filter((e) => this._zoomEnabled && (e.shiftKey || e.buttons == 4))\n\t\t\t.on(\"start\", onStart)\n\t\t\t.on(\"end\", onEnd)\n\t\t\t.on(\"zoom\", onZoom);\n\n\t\tsvg.call(zoom); // add zoom functionality to \"svg\" group\n\n\t\t// d3.select(\"body\").on(\"keydown.grabzoom keyup.grabzoom\", (e) => svg.style('cursor', e.shiftKey ? 'move' : ''));\n\n\t},\n\n\t_initInteractions: function() {\n\t\tthis._initBrush();\n\t\tthis._initRuler();\n\t\tthis._initClipper();\n\t\tthis._initLegend();\n\t},\n\n\t/**\n\t * Toggle chart data on legend click\n\t */\n\t_initLegend: function() {\n\t\tthis._container.on('legend_clicked', (e) => {\n\t\t\tlet { path, legend, name, enabled } = e.detail;\n\n\t\t\tif (!path) return;\n\n\t\t\tlet label = _.select('text', legend);\n\t\t\tlet rect  = _.select('rect', legend);\n\n\t\t\t_.toggleStyle(label, 'text-decoration-line', 'line-through', enabled);\n\t\t\t_.toggleStyle(rect,  'fill-opacity',         '0',            enabled);\n\t\t\t_.toggleClass(path,  'leaflet-hidden',                       enabled);\n\n\t\t\tthis._updateArea();\n\n\t\t\tthis.fire(\"elepath_toggle\", { path, name, legend, enabled })\n\t\t});\n\t},\n\n\t/**\n\t * Initialize \"ruler\".\n\t */\n\t_initRuler: function() {\n\t\tif (!this.options.ruler) return;\n\n\t\t// const yMax      = this._height();\n\t\tconst formatNum = d3.format(\".0f\");\n\t\tconst drag      = this._drag;\n\n\t\tconst label     = (e, d) => {\n\t\t\tlet yMax      = this._height();\n\t\t\tlet y         = this._dragG.data()[0].y;\n\t\t\tif (y >= yMax || y <= 0) this._dragG.select(\".horizontal-drag-label\").text('');\n\t\t\tthis._hideDiagramIndicator();\n\t\t};\n\n\t\tconst position  = (e, d) => {\n\t\t\tlet yMax      = this._height();\n\t\t\tlet yCoord    = d3.pointers(e, this._area.node())[0][1];\n\t\t\tlet y         = yCoord > 0 ? (yCoord < yMax ? yCoord : yMax) : 0;\n\t\t\tlet z         = this._y.invert(y);\n\t\t\tlet data      = L.extend(this._dragG.data()[0], { y: y });\n\n\t\t\tthis._dragG\n\t\t\t\t.data([data])\n\t\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\")\n\t\t\t\t.classed('active', y < yMax);\n\n\t\t\tthis._container.select(\".horizontal-drag-label\")\n\t\t\t\t.text(formatNum(z) + \" \" + this._yLabel);\n\n\t\t\tthis.fire('ruler_filter', { coords: yCoord < yMax && yCoord > 0 ? this._findCoordsForY(yCoord) : [] });\n\t\t}\n\n\t\tdrag\n\t\t.on(\"start end\", label)\n\t\t.on(\"drag\", position);\n\n\t\tthis._dragG.call(drag);\n\n\t},\n\n\t/**\n\t * Initialize x and y scales\n\t */\n\t_initScale: function() {\n\t\tlet opts = this.options;\n\n\t\tthis._registerAxisScale({\n\t\t\taxis    : 'x',\n\t\t\tposition: 'bottom',\n\t\t\tattr    : opts.xAttr,\n\t\t\tmin     : opts.xAxisMin,\n\t\t\tmax     : opts.xAxisMax,\n\t\t\tname    : 'distance'\n\t\t});\n\n\t\tthis._registerAxisScale({\n\t\t\taxis     : 'y',\n\t\t\tposition : 'left',\n\t\t\tattr     : opts.yAttr,\n\t\t\tmin      : opts.yAxisMin,\n\t\t\tmax      : opts.yAxisMax,\n\t\t\tname     : 'altitude'\n\t\t});\n\n\t\tthis._x = this._scales.distance;\n\t\tthis._y = this._scales.altitude;\n\t},\n\n\t_registerAreaPath: function(props) {\n\t\tlet opts = this.options;\n\n\t\tif (!props.xAttr) props.xAttr = opts.xAttr;\n\t\tif (!props.yAttr) props.yAttr = opts.yAttr;\n\t\tif (typeof props.preferCanvas === \"undefined\") props.preferCanvas = opts.preferCanvas;\n\n\t\tlet path = D3.Path(props);\n\n\t\t// Save paths in memory for latter usage\n\t\tthis._paths[props.name]       = path;\n\t\tthis._props.areas[props.name] = props;\n\n\t\tif (opts.legend) {\n\t\t\tthis._props.legendItems[props.name] = {\n\t\t\t\tname   : props.name,\n\t\t\t\tlabel  : props.label,\n\t\t\t\tcolor  : props.color,\n\t\t\t\tpath   : path\n\t\t\t};\n\t\t}\n\n\t},\n\n\t_registerAxisGrid: function(props) {\n\t\tthis._props.grids[props.name || props.axis] = props;\n\t},\n\n\t_registerAxisScale: function(props) {\n\t\tlet opts  = this.options;\n\t\tlet scale = props.scale;\n\n\t\tif (typeof scale !== 'function') {\n\t\t\tscale       = L.extend({\n\t\t\t\tdata       : this._data,\n\t\t\t\tforceBounds: opts.forceAxisBounds\n\t\t\t}, scale);\n\n\t\t\tscale.attr   = scale.attr || props.name;\n\n\t\t\tlet domain   = this._domains[props.name] = D3.Domain(props);\n\t\t\tlet range    = this._ranges[props.name]  = D3.Range(props);\n\t\t\tscale.range  = scale.range  || range(this._width(),this._height());\n\t\t\tscale.domain = scale.domain || domain(this._data);\n\n\t\t\tthis._props.scales[props.name] = scale;\n\n\t\t\tprops.scale = this._scales[props.name] = D3.Scale(scale);\n\t\t}\n\n\t\tif (!props.ticks) {\n\t\t\tif (props.axis == 'x')      props.ticks = opts.xTicks;\n\t\t\telse if (props.axis == 'y') props.ticks = opts.yTicks;\n\t\t}\n\n\t\tthis._props.axes[props.name] = props;\n\n\t\treturn scale;\n\t},\n\n\t/**\n\t * Add a waypoint of interest over the chart\n\t */\n\t_registerCheckPoint: function(point) {\n\t\tif (!this._data.length) return;\n\n\t\tlet item, x, y;\n\n\t\tif (point.latlng) {\n\t\t\titem = this._data[this._findIndexForLatLng(point.latlng)];\n\t\t\tx    = this._x(item.dist);\n\t\t\ty    = this._y(item.z);\n\t\t} else if (!isNaN(point.dist)) {\n\t\t\tx    = this._x(point.dist);\n\t\t\titem = this._data[this._findIndexForXCoord(x)]\n\t\t\ty    = this._y(item.z);\n\t\t} else\n\n\t\tif (isNaN(x) || isNaN(y)) return;\n\n\t\tif (!point.item || !point.item.property('isConnected')) {\n\t\t\tpoint.position = point.position || \"bottom\";\n\n\t\t\tpoint.item = this._point.append('g');\n\n\t\t\tpoint.item.append(\"svg:line\")\n\t\t\t\t.attr(\"y1\", 0)\n\t\t\t\t.attr(\"x1\", 0)\n\t\t\t\t.attr(\"style\",\"stroke: rgb(51, 51, 51); stroke-width: 0.5; stroke-dasharray: 2, 2;\");\n\n\t\t\tpoint.item\n\t\t\t\t.append(\"svg:circle\")\n\t\t\t\t.attr(\"class\", \" height-focus circle-lower\")\n\t\t\t\t.attr(\"r\", 3);\n\n\t\t\tif (point.label) {\n\t\t\t\tpoint.item.append(\"svg:text\")\n\t\t\t\t\t.attr(\"dx\", \"4px\")\n\t\t\t\t\t.attr(\"dy\", \"-4px\");\n\t\t\t}\n\t\t}\n\n\t\tpoint.item\n\t\t\t.datum({\n\t\t\t\tpos: point.position,\n\t\t\t\tx: x,\n\t\t\t\ty: y\n\t\t\t})\n\t\t\t.attr(\"class\", d => \"point \" + d.pos)\n\t\t\t.attr(\"transform\", d => \"translate(\" + d.x + \",\" + d.y + \")\");\n\n\t\tpoint.item.select('line')\n\t\t\t.datum({\n\t\t\t\ty2: ({'top': -y, 'bottom': this._height() - y})[point.position],\n\t\t\t\tx2: ({'left': -x, 'right': this._width() - x})[point.position] || 0\n\t\t\t})\n\t\t\t.attr(\"y2\", d => d.y2)\n\t\t\t.attr(\"x2\", d => d.x2)\n\n\t\tif (point.label) {\n\t\t\tpoint.item.select('text')\n\t\t\t\t.text(point.label);\n\t\t}\n\n\t},\n\n\t_registerFocusLabel: function(props) {\n\t\tthis._props.focusLabels[props.name] = props;\n\t},\n\n\t_updateArea: function() {\n\t\tlet paths = this._paths;\n\t\t// Reset and update chart profiles\n\t\tthis._context.clearRect(0, 0, this._width(), this._height());\n\t\tfor (var i in paths) {\n\t\t\tif (!paths[i].classed('leaflet-hidden')) {\n\t\t\t\tthis._drawPath(i);\n\t\t\t}\n\t\t}\n\t},\n\n\t_updateAxis: function() {\n\n\t\tlet opts = this.options;\n\n\t\t// Reset chart axis.\n\t\tthis._grid.selectAll('g').remove();\n\t\tthis._axis.selectAll('g').remove();\n\n\t\tlet grids = this._props.grids;\n\t\tlet axes  = this._props.axes;\n\t\tlet props, axis, grid;\n\n\t\tlet gridOpts = {\n\t\t\twidth     : this._width(),\n\t\t\theight    : this._height(),\n\t\t\ttickFormat: \"\",\n\t\t};\n\t\tlet axesOpts  = {\n\t\t\twidth  : this._width(),\n\t\t\theight : this._height(),\n\t\t};\n\n\t\t// Render grids\n\t\tfor (let i in grids) {\n\t\t\tprops = L.extend({}, gridOpts, grids[i]);\n\t\t\tgrid  = D3.Grid(props);\n\t\t\tthis._grid.call(grid);\n\t\t}\n\n\t\t// Render axis\n\t\tfor (let i in axes) {\n\t\t\tif (opts[i] === false || opts[i] === 'summary') continue;\n\t\t\tprops = L.extend({}, axesOpts, axes[i]);\n\t\t\taxis  = D3.Axis(props);\n\t\t\tthis._axis.call(axis);\n\t\t}\n\n\t\t// Adjust axis scale positions\n\t\tthis._axis\n\t\t\t.selectAll('.y.axis.right')\n\t\t\t.each((d, i, n) => {\n\n\t\t\t\tlet axis      = d3.select(n[i]);\n\t\t\t\tlet transform = axis.attr('transform');\n\t\t\t\tlet translate = transform.substring(transform.indexOf(\"(\") + 1, transform.indexOf(\")\")).split(\",\");\n\n\t\t\t\taxis.attr('transform', 'translate(' + (+translate[0] + (i * 40)) + ',' + translate[1] + ')')\n\n\t\t\t\tif (i > 0) {\n\t\t\t\t\taxis.select(':scope > path')         .attr('opacity', 0.25);\n\t\t\t\t\taxis.selectAll(':scope > .tick line').attr('opacity', 0.75);\n\t\t\t\t}\n\n\t\t\t});\n\n\t},\n\n\t_updateClipper: function() {\n\t\tlet margin = this.options.margins;\n\n\t\tthis._zoom\n\t\t\t.scaleExtent([1, 10])\n\t\t\t.extent([\n\t\t\t\t[margin.left, 0],\n\t\t\t\t[this._width() - margin.right, this._height()]\n\t\t\t])\n\t\t\t.translateExtent([\n\t\t\t\t[margin.left, -Infinity],\n\t\t\t\t[this._width() - margin.right, Infinity]\n\t\t\t]);\n\n\t},\n\n\t_updateLegend: function () {\n\n\t\tif (this.options.legend == false) return;\n\n\t\tlet legends = this._props.legendItems;\n\t\tlet legend;\n\n\t\t// Reset legend items\n\t\tthis._legend.selectAll('g').remove();\n\t\tfor (var i in legends) {\n\t\t\tlegend = D3.LegendItem(\n\t\t\t\tL.extend({\n\t\t\t\t\twidth  : this._width(),\n\t\t\t\t\theight : this._height(),\n\t\t\t\t\tmargins: this.options.margins,\n\t\t\t\t}, legends[i])\n\t\t\t)\n\t\t\tthis._legend.append(\"g\").call(legend);\n\t\t}\n\n\t\t// Get legend items\n\t\tlet items  = this._legend.selectAll('.legend-item');\n\n\t\t// Calculate legend item positions\n\t\tlet n    = items.nodes().length;\n\t\tlet v      = Array(Math.floor(n / 2)).fill(null).map((d, i) => (i + 1) * 2 - (1 - Math.sign(n % 2)));\n\t\tlet rev    = v.slice().reverse().map((d) => -(d));\n\n\t\tif (n % 2 !== 0) {\n\t\t\trev.push(0);\n\t\t}\n\t\tv = rev.concat(v);\n\n\t\t// Get chart margins\n\t\tlet xAxesB  = this._axis.selectAll('.x.axis.bottom').nodes().length;\n\t\tlet marginB = 30 + (xAxesB * 2);\n\t\tlet marginR = n * 30;\n\n\t\t// Adjust chart right margins\n\t\tif (n && this.options.margins.right < marginR) {\n\t\t\tthis.options.margins.right  = marginR;\n\t\t\tthis.fire('margins_updated');\n\t\t}\n\n\t\t// Adjust chart bottom margins\n\t\tif(xAxesB && this.options.margins.bottom < marginB) {\n\t\t\tthis.options.margins.bottom = marginB;\n\t\t\tthis.fire('margins_updated');\n\t\t}\n\n\t\titems\n\t\t\t.each((d, i, n) => {\n\n\t\t\t\tlet legend  = d3.select(n[i]);\n\t\t\t\tlet rect    = legend.select('rect');\n\t\t\t\tlet name    = legend.attr('data-name');\n\t\t\t\tlet path    = this._paths[name];\n\n\t\t\t\tlet tx      = v[i] * 55;\n\t\t\t\tlet ty      = xAxesB * 2;\n\n\t\t\t\tlegend\n\n\t\t\t\t// Adjust legend item positions\n\t\t\t\t.attr(\"transform\", \"translate(\" + tx + \", \" + ty + \")\");\n\n\t\t\t\t// Set initial state (disabled controls)\n\t\t\t\tif (name in this.options && this.options[name] == 'disabled') {\n\t\t\t\t\tpath.classed('leaflet-hidden', true);\n\t\t\t\t\tlegend.select('text').style('text-decoration-line', 'line-through');\n\t\t\t\t\tlegend.select('rect').style('fill-opacity', '0');\n\t\t\t\t}\n\n\t\t\t\t// Apply d3-zoom (bind <clipPath> mask)\n\t\t\t\tif (this._clipPath) {\n\t\t\t\t\tpath.attr('clip-path', 'url(#' + this._clipPath.attr('id') + ')');\n\t\t\t\t}\n\n\t\t\t});\n\t},\n\n\t_updateScale: function() {\n\t\tif (this.zooming) return { x: this._x, y: this._y };\n\n\t\tlet opts = this.options;\n\n\t\tlet scales  = this._scales;\n\t\tlet d = this._domains;\n\t\tlet r = this._ranges;\n\n\t\tfor (let i in scales) {\n\t\t\tscales[i]\n\t\t\t.domain(d[i](this._data))\n\t\t\t.range(r[i](this._width(), this._height()))\n\t\t}\n\n\t\treturn { x: this._x, y: this._y };\n\t},\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\treturn this._chart._width;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\treturn this._chart._height;\n\t},\n\n\t/*\n\t * Finds data entries above a given y-elevation value and returns geo-coordinates\n\t */\n\t_findCoordsForY: function(y) {\n\t\tlet data = this._data;\n\t\tlet z    = this._y.invert(y);\n\n\t\t// save indexes of elevation values above the horizontal line\n\t\tconst list = data.reduce((array, item, index) => {\n\t\t\tif (item.z >= z) array.push(index);\n\t\t\treturn array;\n\t\t}, []);\n\n\t\tlet start = 0;\n\t\tlet next;\n\n\t\t// split index list into blocks of coordinates\n\t\tconst coords = list.reduce((array, _, curr) => {\n\t\t\tnext = curr + 1;\n\t\t\tif (list[next] !== list[curr] + 1 || next === list.length) {\n\t\t\t\tarray.push(\n\t\t\t\t\tlist\n\t\t\t\t\t.slice(start, next)\n\t\t\t\t\t.map(i => data[i].latlng)\n\t\t\t\t);\n\t\t\t\tstart = next;\n\t\t\t}\n\t\t\treturn array;\n\t\t}, []);\n\n\t\treturn coords;\n\t},\n\n\t/*\n\t * Finds a data entry for a given x-coordinate of the diagram\n\t */\n\t_findIndexForXCoord: function(x) {\n\t\treturn d3\n\t\t\t.bisector(d => d[this.options.xAttr])\n\t\t\t.left(this._data || [0, 1], this._x.invert(x));\n\t},\n\n\t/*\n\t * Finds a data entry for a given latlng of the map\n\t */\n\t_findIndexForLatLng: function(latlng) {\n\t\tlet result = null;\n\t\tlet d      = Infinity;\n\t\tthis._data.forEach((item, index) => {\n\t\t\tlet dist = latlng.distanceTo(item.latlng);\n\t\t\tif (dist < d) {\n\t\t\t\td = dist;\n\t\t\t\tresult = index;\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tif (this._chart.panes.brush.select(\".selection\").attr('width')) {\n\t\t\tthis._chart.panes.brush.call(this._brush.clear);\n\t\t\tthis._hideDiagramIndicator();\n\t\t\tthis.fire('reset_drag');\n\t\t}\n\t},\n\n\t_resetZoom: function() {\n\t\tif (this._zoom) {\n\t\t\tthis._zoom.transform(this._chart.svg, d3.zoomIdentity);\n\t\t}\n\t},\n\n\t/**\n\t * Display distance and altitude level (\"focus-rect\").\n\t */\n\t_showDiagramIndicator: function(item, xCoordinate) {\n\t\tlet opts        = this.options;\n\t\tlet yCoordinate = this._y(item[opts.yAttr]);\n\n\t\tthis._focusG.attr(\"display\", null);\n\n\t\tthis._focusline.call(\n\t\t\tD3.MouseFocusLine({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\theight: this._height()\n\t\t\t})\n\t\t);\n\t\tthis._focuslabel.call(\n\t\t\tD3.MouseFocusLabel({\n\t\t\t\txCoord: xCoordinate,\n\t\t\t\tyCoord: yCoordinate,\n\t\t\t\theight: this._height(),\n\t\t\t\twidth : this._width(),\n\t\t\t\tlabelX: d3.format(\".\"+ opts.decimalsX +\"f\")(item[opts.xAttr]) + \" \" + this._xLabel,\n\t\t\t\tlabelY: d3.format(\".\"+ opts.decimalsY +\"f\")(item[opts.yAttr]) + \" \" + this._yLabel\n\t\t\t})\n\t\t);\n\n\t\t// this._focuslabel.selectAll('tspan').data(Object.values(this._focuslabels));\n\n\t\tlet labels = this._props.focusLabels;\n\t\tlet tooltip = this._focuslabel.select('text');\n\t\tlet label;\n\n\t\tfor (var i in labels) {\n\t\t\tlabel = tooltip.select(\".mouse-focus-label-\" + labels[i].name);\n\n\t\t\tif (!label.size()) {\n\t\t\t\tlabel   = tooltip.append(\"svg:tspan\", \".mouse-focus-label-x\")\n\t\t\t\t\t.attr(\"class\", \"mouse-focus-label-\" + labels[i].name)\n\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t}\n\n\t\t\tlabel.text(typeof labels[i].value !== \"function\" ? labels[i].value : labels[i].value(item) );\n\n\t\t\tthis._focuslabel.select('.mouse-focus-label-x')\n\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t}\n\n\t},\n\n\t_hideDiagramIndicator: function() {\n\t\tthis._focusG.attr(\"display\", 'none');\n\t},\n});\n","import 'leaflet-i18n';\nimport * as _  from './utils';\nimport * as D3 from './components';\n\nexport var Marker = L.Class.extend({\n\n\tinitialize: function(options) {\n\t\tthis.options = options;\n\n\t\tif (this.options.imperial) {\n\t\t\tthis._xLabel = \"mi\";\n\t\t\tthis._yLabel = \"ft\";\n\t\t} else {\n\t\t\tthis._xLabel = this.options.xLabel;\n\t\t\tthis._yLabel = this.options.yLabel;\n\t\t}\n\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\t// this._container = d3.create(\"g\").attr(\"class\", \"height-focus-group\");\n\t\t\tthis._focusline   = d3.create('svg:line');\n\t\t\tthis._focusmarker = d3.create(\"svg:circle\");\n\t\t\tthis._focuslabel  = d3.create(\"svg:text\");\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t// this._marker   = L.circleMarker([0, 0], { pane: 'overlayPane', radius: 6, fillColor: '#fff', fillOpacity:1, color: '#000', weight:1, interactive: false });\n\t\t\tthis._marker      = L.marker([0, 0], { icon: this.options.markerIcon, zIndexOffset: 1000000, interactive: false });\n\t\t}\n\n\t\tthis._focuslabels = {};\n\n\t\treturn this;\n\t},\n\n\taddTo: function(map) {\n\t\tthis._map = map;\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tlet g = this._container = d3.select(map.getPane('elevationPane')).select(\"svg > g\")\n\t\t\t\t.attr(\"class\", \"height-focus-group\");\n\t\t\tg.append(() => this._focusline.node());\n\t\t\tg.append(() => this._focusmarker.node());\n\t\t\tg.append(() => this._focuslabel.node());\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\tthis._marker.addTo(map, { pane: 'overlayPane' });\n\t\t}\n\t\treturn this;\n\t},\n\n\t/**\n\t * Update position marker (\"leaflet-marker\").\n\t */\n\tupdate: function(props) {\n\t\tif (props) this._props = props;\n\t\telse props = this._props;\n\n\t\tif(!props) return;\n\n\t\tif (props.options) this.options = props.options;\n\t\tif (!this._map) this.addTo(props.map);\n\n\t\tlet opts = this.options;\n\t\tlet map = this._map;\n\n\t\tthis._latlng = props.item.latlng;\n\n\t\tlet pos = map.latLngToLayerPoint(this._latlng);\n\n\t\tif (map._rotate) {\n\t\t\tpos = map.rotatedPointToMapPanePoint(pos);\n\t\t}\n\n\t\tlet point = L.extend({}, props.item, pos);\n\n\t\tif (this.options.marker == 'elevation-line') {\n\n\t\t\tlet normalizedAlt = this._height() / props.maxElevation * point.z;\n\t\t\tlet normalizedY   = point.y - normalizedAlt;\n\n\t\t\tthis._container.classed(\"leaflet-hidden\", false);\n\n\t\t\tthis._focusmarker\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusMarker({\n\t\t\t\t\t\ttheme : opts.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t}));\n\n\t\t\tthis._focusline\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLine({\n\t\t\t\t\t\ttheme : opts.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: point.y,\n\t\t\t\t\t\tlength: normalizedY\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\tthis._focuslabel\n\t\t\t\t.call(\n\t\t\t\t\tD3.HeightFocusLabel({\n\t\t\t\t\t\ttheme : opts.theme,\n\t\t\t\t\t\txCoord: point.x,\n\t\t\t\t\t\tyCoord: normalizedY,\n\t\t\t\t\t\tlabel : d3.format(\".\" + opts.decimalsY + \"f\")(point[opts.yAttr]) + \" \" + this._yLabel\n\t\t\t\t\t})\n\t\t\t\t);\n\n\t\t\tlet labels = this._focuslabels;\n\t\t\tlet tooltip = this._focuslabel;\n\t\t\tlet label;\n\n\t\t\tfor (var i in labels) {\n\t\t\t\tlabel = tooltip.select(\".height-focus-\" + labels[i].name);\n\n\t\t\t\tif (!label.size()) {\n\t\t\t\t\tlabel   = tooltip.append(\"svg:tspan\")\n\t\t\t\t\t\t.attr(\"class\", \"height-focus-\" + labels[i].name)\n\t\t\t\t\t\t.attr(\"dy\", \"1.5em\");\n\t\t\t\t}\n\n\t\t\t\tlabel.text(typeof labels[i].value !== \"function\" ? labels[i].value : labels[i].value(props.item) );\n\n\t\t\t\tthis._focuslabel.select('.height-focus-y')\n\t\t\t\t\t.attr(\"dy\", \"-1.5em\");\n\t\t\t}\n\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.removeClass(this._marker.getElement(), 'leaflet-hidden');\n\t\t\tthis._marker.setLatLng(this._latlng);\n\t\t}\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\tremove: function() {\n\t\tthis._props = null;\n\t\tif (this.options.marker == 'elevation-line') {\n\t\t\tif (this._container) this._container.classed(\"leaflet-hidden\", true);\n\t\t} else if (this.options.marker == 'position-marker') {\n\t\t\t_.addClass(this._marker.getElement(), 'leaflet-hidden');\n\t\t}\n\t},\n\n\tgetLatLng: function() {\n\t\treturn this._latlng;\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t_registerFocusLabel: function(props) {\n\t\tthis._focuslabels[props.name] = props;\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\n\nexport var Summary = L.Class.extend({\n\tinitialize: function(opts, control) {\n\t\tthis.options = opts;\n\t\tthis.control = control;\n\n\t\tlet summary = this._container = _.create(\"div\", \"elevation-summary \" + (opts.summary ? opts.summary + \"-summary\" : ''));\n\t\t_.style(summary, 'max-width', opts.width ? opts.width + 'px' : '');\n\t},\n\n\trender: function() {\n\t\treturn container => container.append(() => this._container);\n\t},\n\n\treset: function() {\n\t\tthis._container.innerHTML = '';\n\t},\n\n\tappend: function(className, label, value) {\n\t\tthis._container.innerHTML += `<span class=\"${className}\"><span class=\"summarylabel\">${label}</span><span class=\"summaryvalue\">${value}</span></span>`;\n\t\treturn this;\n\t},\n\n\t_registerSummary: function(data) {\n\t\tfor (let i in data) {\n\t\t\tthis.append(i, L._(data[i].label), typeof data[i].value !== \"function\" ? data[i].value : data[i].value(this.control.track_info));\n\t\t}\n\t}\n\n});\n","import * as _ from './utils';\n\nexport var Options = {\n\tautofitBounds: true,\n\tautohide: !L.Browser.mobile,\n\tautohideMarker: true,\n\talmostover: true,\n\taltitude: true,\n\tcollapsed: false,\n\tdetached: true,\n\tdistance: true,\n\tdistanceFactor: 1,\n\tdistanceMarkers: false,\n\tdecimalsX: 2,\n\tdecimalsY: 0,\n\tdragging: !L.Browser.mobile,\n\tdownloadLink: 'link',\n\televationDiv: \"#elevation-div\",\n\tfollowMarker: true,\n\tforceAxisBounds: false,\n\tgpxOptions: {\n\t\tasync: true,\n\t\tmarker_options: {\n\t\t\tstartIconUrl: null,\n\t\t\tendIconUrl: null,\n\t\t\tshadowUrl: null,\n\t\t\twptIcons: {\n\t\t\t\t'': L.divIcon({\n\t\t\t\t\tclassName: 'elevation-waypoint-marker',\n\t\t\t\t\thtml: '<i class=\"elevation-waypoint-icon\"></i>',\n\t\t\t\t\ticonSize: [30, 30],\n\t\t\t\t\ticonAnchor: [8, 30],\n\t\t\t\t})\n\t\t\t},\n\t\t},\n\t},\n\theight: 200,\n\theightFactor: 1,\n\timperial: false,\n\tinterpolation: \"curveLinear\",\n\tlazyLoadJS: true,\n\tlegend: true,\n\tloadData: {\n\t\tdefer: false,\n\t\tlazy: false,\n\t},\n\tmargins: {\n\t\ttop: 30,\n\t\tright: 30,\n\t\tbottom: 30,\n\t\tleft: 40\n\t},\n\tmarker: 'elevation-line',\n\tmarkerIcon: L.divIcon({\n\t\tclassName: 'elevation-position-marker',\n\t\thtml: '<i class=\"elevation-position-icon\"></i>',\n\t\ticonSize: [32, 32],\n\t\ticonAnchor: [16, 16],\n\t}),\n\tplaceholder: false,\n\tposition: \"topright\",\n\tpolyline: {\n\t\tclassName: 'elevation-polyline',\n\t\tcolor: '#000',\n\t\topacity: 0.75,\n\t\tweight: 5,\n\t\tlineCap: 'round'\n\t},\n\tpolylineSegments: {\n\t\tclassName: 'elevation-polyline-segments',\n\t\tcolor: '#F00',\n\t\tinteractive: false,\n\t},\n\tpreferCanvas: false,\n\treverseCoords: false,\n\truler: true,\n\tskipNullZCoords: false,\n\ttheme: \"lightblue-theme\",\n\tresponsive: true,\n\tsummary: 'inline',\n\tslope: false,\n\tspeed: false,\n\tsLimit: undefined,\n\ttime: false,\n\ttimeFactor: 3600,\n\ttimeFormat: false,\n\tsDeltaMax: undefined,\n\tsInterpolation: \"curveStepAfter\",\n\tsRange: undefined,\n\twidth: 600,\n\twaypoints: true,\n\txAttr: \"dist\",\n\txLabel: \"km\",\n\txTicks: undefined,\n\tyAttr: \"z\",\n\tyAxisMax: undefined,\n\tyAxisMin: undefined,\n\tyLabel: \"m\",\n\tyTicks: undefined,\n\tzFollow: false,\n\tzooming: !L.Browser.Mobile,\n};\n","import 'leaflet-i18n';\nimport * as _      from './utils';\nimport * as D3     from './components';\nimport { Chart }   from './chart';\nimport { Marker }  from './marker';\nimport { Summary } from './summary';\nimport { Options } from './options';\n\nexport const Elevation = L.Control.Elevation = L.Control.extend({\n\n\tincludes: L.Evented ? L.Evented.prototype : L.Mixin.Events,\n\n\toptions: Options,\n\t__mileFactor: 0.621371,\n\t__footFactor: 3.28084,\n\t__D3:          'https://unpkg.com/d3@6.5.0/dist/d3.min.js',\n\t__TOGEOJSON:   'https://unpkg.com/@tmcw/togeojson@4.3.0/dist/togeojson.umd.js',\n\t__LGEOMUTIL:   'https://unpkg.com/leaflet-geometryutil@0.9.3/src/leaflet.geometryutil.js',\n\t__LALMOSTOVER: 'https://unpkg.com/leaflet-almostover@1.0.1/src/leaflet.almostover.js',\n\t__LDISTANCEM:  'https://unpkg.com/@raruto/leaflet-elevation@1.7.0/libs/leaflet-distance-marker.min.js',\n\n\t/*\n\t * Add data to the diagram either from GPX or GeoJSON and update the axis domain and data\n\t */\n\taddData: function(d, layer) {\n\t\tif ((typeof layer === \"undefined\" || layer === null) && d.on) {\n\t\t\tlayer = d;\n\t\t}\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._addData(d);\n\t\t\tthis._addLayer(layer);\n\t\t\tthis._fireEvt(\"eledata_added\", { data: d, layer: layer, track_info: this.track_info });\n\t\t});\n\t},\n\n\t/**\n\t * Adds the control to the given map.\n\t */\n\taddTo: function(map) {\n\t\tif (this.options.detached) {\n\t\t\tlet eleDiv = this._initElevationDiv();\n\t\t\tif (!eleDiv.isConnected) _.insert(map.getContainer(), eleDiv, 'afterend');\n\t\t\t_.append(eleDiv, this.onAdd(map));\n\t\t} else {\n\t\t\tL.Control.prototype.addTo.call(this, map);\n\t\t}\n\t\treturn this;\n\t},\n\n\t/*\n\t * Reset data and display\n\t */\n\tclear: function() {\n\t\tif (this._marker) this._marker.remove();\n\t\tif (this._chart)  this._chart.clear();\n\t\tif (this._layers) this._layers.clearLayers();\n\n\t\tthis._data      = [];\n\t\tthis.track_info = {};\n\n\t\tthis._fireEvt(\"eledata_clear\");\n\t},\n\n\t/**\n\t * Disable chart brushing.\n\t */\n\tdisableBrush: function() {\n\t\tthis._chart._brushEnabled = false;\n\t\tthis._resetDrag();\n\t},\n\n\t/**\n\t * Enable chart brushing.\n\t */\n\tenableBrush: function() {\n\t\tthis._chart._brushEnabled = true;\n\t},\n\n\t/**\n\t * Alias for enableBrush\n\t */\n\tenableDragging: function() {\n\t\tthis.enableBrushing();\n\t},\n\n\t/**\n\t * Alias for disableBrush\n\t */\n\tdisableDragging: function() {\n\t\tthis.disableBrushing();\n\t},\n\n\t/**\n\t * Disable chart zooming.\n\t */\n\tdisableZoom: function() {\n\t\tthis._chart._zoomEnabled = false;\n\t\tthis._chart._resetZoom();\n\t},\n\n\t/**\n\t * Enable chart zooming.\n\t */\n\tenableZoom: function() {\n\t\tthis._chart._zoomEnabled = true;\n\t},\n\n\t/**\n\t * Sets a map view that contains the given geographical bounds.\n\t */\n\tfitBounds: function(bounds) {\n\t\tbounds = bounds || this.getBounds();\n\t\tif (this._map && bounds.isValid()) this._map.fitBounds(bounds);\n\t},\n\n\tgetBounds: function(data) {\n\t\tdata = data || this._data;\n\t\treturn L.latLngBounds(data.map((d) => d.latlng));\n\t},\n\n\t/**\n\t * Get default zoom level when \"followMarker\" is true.\n\t */\n\tgetZFollow: function() {\n\t\treturn this._zFollow;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\thide: function() {\n\t\t_.style(this._container, \"display\", \"none\");\n\t},\n\n\t/**\n\t * Initialize chart control \"options\" and \"container\".\n\t */\n\tinitialize: function(options) {\n\t\tthis._data           = [];\n\t\tthis._layers         = L.featureGroup();\n\t\tthis._markedSegments = L.polyline([]);\n\t\tthis._chartEnabled   = true,\n\n\t\tthis.track_info      = {};\n\n\t\tthis.options         = _.deepMerge({}, this.options, options);\n\n\t\tthis._zFollow        = this.options.zFollow;\n\n\t\tif (this.options.followMarker) this._setMapView = L.Util.throttle(this._setMapView, 300, this);\n\t\tif (this.options.placeholder)  this.options.loadData.lazy = this.options.loadData.defer = true;\n\n\t\tif (this.options.legend)       this.options.margins.bottom += 30;\n\n\t\tif (this.options.theme)        this.options.polylineSegments.className += ' ' + this.options.theme;\n\n\t\tthis._markedSegments.setStyle(this.options.polylineSegments);\n\n\t\t// this._resizeChart   = _.debounce(this._resizeChart,   300, this);\n\t\t// this._resizeChart = L.Util.throttle(this._resizeChart, 300, this);\n\n\t\t// if (L.Browser.mobile) {\n\t\t// \tthis._updateChart   = _.debounce(this._updateChart,   300, this);\n\t\t// \tthis._updateSummary = _.debounce(this._updateSummary, 300, this);\n\t\t// }\n\n\t\t// Leaflet canvas renderer colors\n\t\tL.extend(D3.Colors, this.options.colors || {});\n\t},\n\n\t/**\n\t * Alias for loadData\n\t */\n\tload: function(data, opts) {\n\t\tthis.loadData(data, opts);\n\t},\n\n\t/**\n\t * Alias for addTo\n\t */\n\tloadChart: function(map) {\n\t\tthis.addTo(map);\n\t},\n\n\t/**\n\t * Load elevation data (GPX, GeoJSON or KML).\n\t */\n\tloadData: function(data, opts) {\n\t\topts = L.extend({}, this.options.loadData, opts);\n\t\tif (opts.defer) {\n\t\t\tthis.loadDefer(data, opts);\n\t\t} else if (opts.lazy) {\n\t\t\tthis.loadLazy(data, opts);\n\t\t} else if (_.isXMLDoc(data)) {\n\t\t\tthis.loadXML(data);\n\t\t} else if (_.isJSONDoc(data)) {\n\t\t\tthis.loadGeoJSON(data);\n\t\t} else {\n\t\t\tthis.loadFile(data);\n\t\t}\n\t},\n\n\t/**\n\t * Wait for document load before download data.\n\t */\n\tloadDefer: function(data, opts) {\n\t\topts       = L.extend({}, this.options.loadData, opts);\n\t\topts.defer = false;\n\t\t_.deferFunc(L.bind(this.loadData, this, data, opts));\n\t},\n\n\t/**\n\t * Load data from a remote url.\n\t */\n\tloadFile: function(url) {\n\t\tfetch(url)\n\t\t\t.then((response) => response.text())\n\t\t\t.then((data)     => {\n\t\t\t\tthis._downloadURL = url; // TODO: handle multiple urls?\n\t\t\t\tthis.loadData(data, { lazy: false, defer: false });\n\t\t\t})\n\t\t\t.catch((err) => console.warn(err));\n\t},\n\n\t/**\n\t * Load raw GeoJSON data.\n\t */\n\tloadGeoJSON: function(data) {\n\t\t_.GeoJSONLoader(data, this);\n\t},\n\n\t/**\n\t * Alias for loadXML\n\t */\n\tloadGPX: function(data){\n\t\tthis.loadXML(data);\n\t},\n\n\t/**\n\t * Load raw XML data.\n\t */\n\tloadXML: function(data) {\n\t\tElevation._togeojsonLazyLoader = _.lazyLoader(\n\t\t\tthis.__TOGEOJSON,\n\t\t\ttypeof toGeoJSON !== 'function' || !this.options.lazyLoadJS,\n\t\t\tElevation._togeojsonLazyLoader\n\t\t).then(\n\t\t\t() => {\n\t\t\t\tlet xml     = (new DOMParser()).parseFromString(data, \"text/xml\");\n\t\t\t\tlet type    = xml.documentElement.tagName.toLowerCase(); // \"kml\" or \"gpx\"\n\t\t\t\tif (!(type in toGeoJSON)) {\n\t\t\t\t\ttype = xml.documentElement.tagName == \"TrainingCenterDatabase\" ? 'tcx' : 'gpx';\n\t\t\t\t}\n\t\t\t\tlet geojson = toGeoJSON[type](xml);\n\t\t\t\tlet name    = xml.getElementsByTagName('name');\n\t\t\t\tif(name[0]) { geojson.name = name[0].innerHTML; }\n\t\t\t\telse if(this._downloadURL) { geojson.name = this._downloadURL.split('/').pop().split('#')[0].split('?')[0]; }\n\n\t\t\t\treturn this.loadGeoJSON(geojson, this);\n\t\t\t}\n\t\t);\n\t},\n\n\t/**\n\t * Wait for chart container visible before download data.\n\t */\n\tloadLazy: function(data, opts) {\n\t\topts     = L.extend({}, this.options.loadData, opts);\n\t\tlet elem = opts.lazy.parentNode ? opts.lazy : this.placeholder;\n\t\t_.waitHolder(elem)\n\t\t\t.then(() => {\n\t\t\t\topts.lazy = false;\n\t\t\t\tthis.loadData(data, opts)\n\t\t\t\tthis.once('eledata_loaded', () => this.placeholder.parentNode.removeChild(elem));\n\t\t\t});\n\t},\n\n\t/**\n\t * Create container DOM element and related event listeners.\n\t * Called on control.addTo(map).\n\t */\n\tonAdd: function(map) {\n\t\tthis._map = map;\n\n\t\tlet container = this._container = _.create(\"div\", \"elevation-control elevation \" + this.options.theme);\n\n\t\tif (!this.options.detached) {\n\t\t\t_.addClass(container, 'leaflet-control');\n\t\t}\n\n\t\tif (this.options.placeholder && !this._data.length) {\n\t\t\tthis.placeholder = _.create('img', 'elevation-placeholder', typeof this.options.placeholder === 'string' ? { src: this.options.placeholder, alt: '' } : this.options.placeholder);\n\t\t\t_.insert(container, this.placeholder, 'afterbegin');\n\t\t}\n\n\t\tElevation._d3LazyLoader = _.lazyLoader(\n\t\t\tthis.__D3,\n\t\t\ttypeof d3 !== 'object' || !this.options.lazyLoadJS,\n\t\t\tElevation._d3LazyLoader\n\t\t).then(() => {\n\t\t\tthis._initButton(container);\n\t\t\tthis._initChart(container);\n\t\t\tthis._initSummary(container);\n\t\t\tthis._initMarker(map);\n\t\t\tthis._initLayer(map);\n\n\t\t\tmap\n\t\t\t\t.on('zoom viewreset zoomanim',       this._hideMarker,    this)\n\t\t\t\t.on('resize',                        this._resetView,     this)\n\t\t\t\t.on('resize',                        this._resizeChart,   this)\n\t\t\t\t.on('rotate',                        this._rotateMarker,  this)\n\t\t\t\t.on('mousedown',                     this._resetDrag,     this);\n\n\t\t\t_.on(map.getContainer(), 'mousewheel', this._resetDrag,     this);\n\t\t\t_.on(map.getContainer(), 'touchstart', this._resetDrag,     this);\n\n\t\t\tthis\n\t\t\t\t.on('eledata_added eledata_loaded',  this._updateChart,   this)\n\t\t\t\t.on('eledata_added eledata_loaded',  this._updateSummary, this);\n\n\t\t\tthis._updateChart();\n\t\t\tthis._updateSummary();\n\t\t});\n\n\t\treturn container;\n\t},\n\n\t/**\n\t * Clean up control code and related event listeners.\n\t * Called on control.remove().\n\t */\n\tonRemove: function(map) {\n\t\tthis._container = null;\n\n\t\tmap\n\t\t\t.off('zoom viewreset zoomanim',       this._hideMarker,    this)\n\t\t\t.off('resize',                        this._resetView,     this)\n\t\t\t.off('resize',                        this._resizeChart,   this)\n\t\t\t.off('mousedown',                     this._resetDrag,     this);\n\n\t\t_.off(map.getContainer(), 'mousewheel', this._resetDrag,     this);\n\t\t_.off(map.getContainer(), 'touchstart', this._resetDrag,     this);\n\n\t\tthis\n\t\t\t.off('eledata_added eledata_loaded',  this._updateChart,   this)\n\t\t\t.off('eledata_added eledata_loaded',  this._updateSummary, this);\n\t},\n\n\t/**\n\t * Redraws the chart control. Sometimes useful after screen resize.\n\t */\n\tredraw: function() {\n\t\tthis._resizeChart();\n\t},\n\n\t/**\n\t * Set default zoom level when \"followMarker\" is true.\n\t */\n\tsetZFollow: function(zoom) {\n\t\tthis._zFollow = zoom;\n\t},\n\n\t/**\n\t * Hide current elevation chart profile.\n\t */\n\tshow: function() {\n\t\t_.style(this._container, \"display\", \"block\");\n\t},\n\n\t/*\n\t * Parsing data either from GPX or GeoJSON and update the diagram data\n\t */\n\t_addData: function(d) {\n\t\tif (!d) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet geom = d.geometry;\n\t\tif (geom) {\n\t\t\tswitch (geom.type) {\n\t\t\t\tcase 'LineString':\n\t\t\t\t\tthis._addGeoJSONData(geom.coordinates);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'MultiLineString':\n\t\t\t\t\t_.each(geom.coordinates, coords => this._addGeoJSONData(coords));\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn('Unsopperted GeoJSON feature geometry type:' + geom.type);\n\t\t\t}\n\t\t}\n\n\t\tif (d.type === \"FeatureCollection\") {\n\t\t\t_.each(d.features, feature => this._addData(feature));\n\t\t}\n\n\t\tif (d._latlngs) {\n\t\t\tthis._addGPXData(d._latlngs);\n\t\t}\n\t},\n\n\t/*\n\t * Parsing of GeoJSON data lines and their elevation in z-coordinate\n\t */\n\t_addGeoJSONData: function(coords) {\n\t\t_.each(coords, point => {\n\t\t\tthis._addPoint(point[1], point[0], point[2]);\n\t\t\tthis._fireEvt(\"elepoint_added\", { point: point, index: this._data.length - 1 });\n\t\t});\n\t\tthis._fireEvt(\"eletrack_added\", { coords: coords, index: this._data.length - 1 });\n\t},\n\n\t/*\n\t * Parsing function for GPX data and their elevation in z-coordinate\n\t */\n\t_addGPXData: function(coords) {\n\t\t_.each(coords, point => {\n\t\t\tthis._addPoint(point.lat, point.lng, point.meta.ele);\n\t\t\tthis._fireEvt(\"elepoint_added\", { point: point, index: this._data.length - 1 });\n\t\t});\n\t\tthis._fireEvt(\"eletrack_added\", { coords: coords, index: this._data.length - 1 });\n\t},\n\n\t/*\n\t * Parse and push a single (x, y, z) point to current elevation profile.\n\t */\n\t_addPoint: function(x, y, z) {\n\t\tif (this.options.reverseCoords) {\n\t\t\t[x, y] = [y, x];\n\t\t}\n\n\t\tthis._data.push({\n\t\t\tx: x,\n\t\t\ty: y,\n\t\t\tz: z,\n\t\t\tlatlng: L.latLng(x, y, z)\n\t\t});\n\n\t\tthis._fireEvt(\"eledata_updated\", { index: this._data.length - 1 });\n\t},\n\n\t_addLayer: function(layer) {\n\t\tif (layer) this._layers.addLayer(layer)\n\t},\n\n\t/**\n\t * Adds the control to the given \"detached\" div.\n\t */\n\t_initElevationDiv: function() {\n\t\tlet eleDiv = _.select(this.options.elevationDiv);\n\t\tif (!eleDiv) {\n\t\t\tthis.options.elevationDiv = '#elevation-div_' + _.randomId();\n\t\t\teleDiv                    = _.create('div', 'leaflet-control elevation elevation-div', { id: this.options.elevationDiv.substr(1) });\n\t\t}\n\t\tif (this.options.detached) {\n\t\t\t_.replaceClass(eleDiv, 'leaflet-control', 'elevation-detached');\n\t\t}\n\t\tthis.eleDiv = eleDiv;\n\t\treturn this.eleDiv;\n\t},\n\n\t/*\n\t * Collapse current chart control.\n\t */\n\t_collapse: function() {\n\t\t_.replaceClass(this._container, 'elevation-expanded', 'elevation-collapsed');\n\t},\n\n\t/*\n\t * Expand current chart control.\n\t */\n\t_expand: function() {\n\t\t_.replaceClass(this._container, 'elevation-collapsed', 'elevation-expanded');\n\t},\n\n\t/*\n\t * Finds a data entry for the given LatLng\n\t */\n\t_findItemForLatLng: function(latlng) {\n\t\treturn this._data[this._chart._findIndexForLatLng(latlng)];\n\t},\n\n\t/*\n\t * Finds a data entry for the given xDiagCoord\n\t */\n\t_findItemForX: function(x) {\n\t\treturn this._data[this._chart._findIndexForXCoord(x)];\n\t},\n\n\t/**\n\t * Fires an event of the specified type.\n\t */\n\t_fireEvt: function(type, data, propagate) {\n\t\tif (this.fire) this.fire(type, data, propagate);\n\t\tif (this._map) this._map.fire(type, data, propagate);\n\t},\n\n\t/**\n\t * Calculates chart height.\n\t */\n\t_height: function() {\n\t\tif (this._chart) return this._chart._height();\n\t\tlet opts = this.options;\n\t\treturn opts.height - opts.margins.top - opts.margins.bottom;\n\t},\n\n\t/*\n\t * Hides the position/height indicator marker drawn onto the map\n\t */\n\t_hideMarker: function() {\n\t\tif (this.options.autohideMarker) {\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Generate \"svg\" chart DOM element.\n\t */\n\t_initChart: function(container) {\n\t\tlet opts    = this.options;\n\n\t\topts.xTicks = this._xTicks();\n\t\topts.yTicks = this._yTicks();\n\n\t\tif (opts.responsive) {\n\t\t\tif (opts.detached) {\n\t\t\t\tlet { offsetWidth, offsetHeight}             = this.eleDiv;\n\t\t\t\tif (offsetWidth > 0)             opts.width  = offsetWidth;\n\t\t\t\tif (offsetHeight > 20)           opts.height = offsetHeight - 20; // 20 = horizontal scrollbar size.\n\t\t\t} else {\n\t\t\t\tlet { clientWidth }                          = this._map.getContainer();\n\t\t\t\topts._maxWidth                               = opts._maxWidth > opts.width ? opts._maxWidth : opts.width;\n\t\t\t\tthis._container.style.maxWidth               = opts._maxWidth + 'px';\n\t\t\t\tif (opts._maxWidth > clientWidth) opts.width = clientWidth - 30;\n\t\t\t}\n\t\t}\n\n\t\tlet chart = this._chart = new Chart(opts, this);\n\n\t\tthis._x     = this._chart._x;\n\t\tthis._y     = this._chart._y;\n\n\t\td3\n\t\t\t.select(container)\n\t\t\t.call(chart.render())\n\n\t\tchart\n\t\t\t.on('reset_drag',     this._hideMarker,                     this)\n\t\t\t.on('mouse_enter',    this._fireEvt.bind('elechart_enter'), this)\n\t\t\t.on('dragged',        this._dragendHandler,                 this)\n\t\t\t.on('mouse_move',     this._mousemoveHandler,               this)\n\t\t\t.on('mouse_out',      this._mouseoutHandler,                this)\n\t\t\t.on('ruler_filter',   this._rulerFilterHandler,             this)\n\t\t\t.on('zoom',           this._updateChart,                    this)\n\t\t\t.on('elepath_toggle', this._toggleChartHandler,             this)\n\t\t\t.on('margins_updated',this._resizeChart,                    this);\n\n\n\t\tthis._fireEvt(\"elechart_axis\");\n\t\tif (this.options.legend) this._fireEvt(\"elechart_legend\");\n\n\t\tthis._fireEvt(\"elechart_init\");\n\t},\n\n\t_initLayer: function() {\n\t\tthis._layers\n\t\t\t.on('layeradd layerremove', (e) => {\n\t\t\t\tlet layer = e.layer\n\t\t\t\tlet node  = layer.getElement && layer.getElement();\n\t\t\t\t_.toggleClass(node,  this.options.polyline.className + ' ' + this.options.theme, e.type == 'layeradd');\n\t\t\t\t_.toggleEvent(layer, \"mousemove\", this._mousemoveLayerHandler.bind(this),        e.type == 'layeradd')\n\t\t\t\t_.toggleEvent(layer, \"mouseout\",  this._mouseoutHandler.bind(this),              e.type == 'layeradd');\n\t\t\t});\n\t},\n\n\t_initMarker: function(map) {\n\t\tlet pane                   = map.getPane('elevationPane');\n\t\tif (!pane) {\n\t\t\tpane = this._pane        = map.createPane('elevationPane', map.getPane('norotatePane') || map.getPane('mapPane'));\n\t\t\tpane.style.zIndex        = 625; // This pane is above markers but below popups.\n\t\t\tpane.style.pointerEvents = 'none';\n\t\t}\n\n\t\tif (this._renderer) this._renderer.remove()\n\t\tthis._renderer             = L.svg({ pane: \"elevationPane\" }).addTo(this._map); // default leaflet svg renderer\n\t\tthis._marker               = new Marker(this.options);\n\n\t\tthis._fireEvt(\"elechart_marker\");\n\t},\n\n\t/**\n\t * Inspired by L.Control.Layers\n\t */\n\t_initButton: function(container) {\n\t\t//Makes this work on IE10 Touch devices by stopping it from firing a mouseout event when the touch is released\n\t\tcontainer.setAttribute('aria-haspopup', true);\n\n\t\tif (!this.options.detached) {\n\t\t\tL.DomEvent\n\t\t\t\t.disableClickPropagation(container);\n\t\t\t//.disableScrollPropagation(container);\n\t\t}\n\n\t\tif (L.Browser.mobile) {\n\t\t\t_.on(container, 'click', L.DomEvent.stopPropagation);\n\t\t}\n\n\t\t_.on(container, 'mousewheel', this._mousewheelHandler, this);\n\n\t\tif (!this.options.detached) {\n\t\t\tlet link = this._button = _.create('a', \"elevation-toggle elevation-toggle-icon\" + (this.options.autohide ? \"\" : \" close-button\"), { href: '#', title: L._('Elevation') }, container);\n\n\t\t\tif (this.options.collapsed) {\n\t\t\t\tthis._collapse();\n\t\t\t\tif (this.options.autohide) {\n\t\t\t\t\t_.on(container, 'mouseover', this._expand,   this);\n\t\t\t\t\t_.on(container, 'mouseout',  this._collapse, this);\n\t\t\t\t} else {\n\t\t\t\t\t_.on(link, 'click', L.DomEvent.stop);\n\t\t\t\t\t_.on(link, 'click', this._toggle, this);\n\t\t\t\t}\n\n\t\t\t\t_.on(link, 'focus', this._toggle, this);\n\n\t\t\t\tthis._map.on('click', this._collapse, this);\n\t\t\t\t// TODO: keyboard accessibility\n\t\t\t}\n\t\t} else {\n\t\t\t// TODO: handle autohide when detached=true\n\t\t}\n\t},\n\n\t_initSummary: function(container) {\n\t\tlet summary = this._summary = new Summary({ summary: this.options.summary }, this);\n\n\t\td3\n\t\t\t.select(container)\n\t\t\t.call(summary.render());\n\n\t\tthis.summaryDiv = this._summary._container;\n\t},\n\n\t_dragendHandler: function(e) {\n\t\tthis._hideMarker();\n\t\tthis.fitBounds(L.latLngBounds([e.dragstart.latlng, e.dragend.latlng]));\n\n\t\tthis._fireEvt(\"elechart_dragged\");\n\t},\n\n\t/*\n\t * Handles the moueseover the chart and displays distance and altitude level.\n\t */\n\t_mousemoveHandler: function(e) {\n\t\tif (!this._data.length || !this._chartEnabled) {\n\t\t\treturn;\n\t\t}\n\t\tlet item = this._findItemForX(e.xCoord);\n\n\t\tif (item) {\n\t\t\tlet xCoord = e.xCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._updateMarker(item);\n\t\t\tthis._setMapView(item);\n\n\t\t\tif (this._map) {\n\t\t\t\t_.addClass(this._map.getContainer(), 'elechart-hover');\n\t\t\t}\n\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t\tthis._fireEvt(\"elechart_hover\",  { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles mouseover events of the data layers on the map.\n\t */\n\t_mousemoveLayerHandler: function(e) {\n\t\tif (!this._data.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet item = this._findItemForLatLng(e.latlng);\n\t\tif (item) {\n\t\t\tlet xCoord = item.xDiagCoord;\n\n\t\t\tif (this._chartEnabled) this._chart._showDiagramIndicator(item, xCoord);\n\n\t\t\tthis._updateMarker(item);\n\n\t\t\tthis._fireEvt(\"elechart_change\", { data: item, xCoord: xCoord });\n\t\t}\n\t},\n\n\t/*\n\t * Handles the moueseout over the chart.\n\t */\n\t_mouseoutHandler: function() {\n\t\tif (!this.options.detached) {\n\t\t\tthis._hideMarker();\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t}\n\n\t\tif (this._map) {\n\t\t\t_.removeClass(this._map.getContainer(), 'elechart-hover');\n\t\t}\n\n\t\tthis._fireEvt(\"elechart_leave\");\n\t},\n\n\t/*\n\t * Handles the mouesewheel over the chart.\n\t */\n\t_mousewheelHandler: function(e) {\n\t\tif (this._map.gestureHandling && this._map.gestureHandling._enabled) return;\n\t\tlet ll = this._marker.getLatLng() || this._map.getCenter();\n\t\tlet z  = this._map.getZoom() + Math.sign(e.deltaY);\n\t\tthis._resetDrag();\n\t\tthis._map.flyTo(ll, z);\n\t},\n\n\t/**\n\t * Add a waypoint marker to the diagram\n\t */\n\t_registerCheckPoint: function(props) {\n\t\tthis.on(\"elechart_updated\", () => this._chart._registerCheckPoint(props));\n\t},\n\n\t/**\n\t * Add chart profile to diagram\n\t */\n\t_registerAreaPath: function(props) {\n\t\tthis.on(\"elechart_init\", () => this._chart._registerAreaPath(props));\n\t},\n\n\t/**\n\t * Add chart grid to diagram\n\t */\n\t_registerAxisGrid: function(props) {\n\t\tthis.on(\"elechart_axis\", () => this._chart._registerAxisGrid(props));\n\t},\n\n\t/**\n\t * Add chart axis to diagram\n\t */\n\t_registerAxisScale: function(props) {\n\t\tthis.on(\"elechart_axis\", () => this._chart._registerAxisScale(props));\n\t},\n\n\t/**\n\t * Add chart or marker tooltip info\n\t */\n\t_registerFocusLabel: function(props) {\n\t\tif (props.chart) {\n\t\t\tlet label = L.extend({}, props, { value: props.chart });\n\t\t\tthis.on(\"elechart_init\",   () => this._chart._registerFocusLabel(label));\n\t\t}\n\t\tif (props.marker) {\n\t\t\tlet label = L.extend({}, props, { value: props.marker });\n\t\t\tthis.on(\"elechart_marker\", () => this._marker._registerFocusLabel(label));\n\t\t}\n\t},\n\n\t/**\n\t * Add summary info to diagram\n\t */\n\t_registerSummary: function(props) {\n\t\tthis.on('elechart_summary',  () => this._summary._registerSummary(props));\n\t},\n\n\t/*\n\t * Removes the drag rectangle and zoms back to the total extent of the data.\n\t */\n\t_resetDrag: function() {\n\t\tthis._chart._resetDrag();\n\t\tthis._hideMarker();\n\t},\n\n\t/**\n\t * Resets drag, marker and bounds.\n\t */\n\t_resetView: function() {\n\t\tif (this._map && this._map._isFullscreen) return;\n\t\tthis._resetDrag();\n\t\tthis._hideMarker();\n\t\tif (this.options.autofitBounds) {\n\t\t\tthis.fitBounds();\n\t\t}\n\t},\n\n\t/**\n\t * Hacky way for handling chart resize. Deletes it and redraw chart.\n\t */\n\t_resizeChart: function() {\n\t\t// prevent displaying chart on resize if hidden\n\t\tif (_.style(this._container, \"display\") == \"none\") return;\n\n\t\tlet opts = this.options;\n\n\t\tif (opts.responsive) {\n\t\t\tlet newWidth;\n\t\t\tif (opts.detached) {\n\t\t\t\tnewWidth = (this.eleDiv || this._container).offsetWidth;\n\t\t\t} else {\n\t\t\t\tlet { clientWidth } = this._map.getContainer();\n\t\t\t\tnewWidth = opts._maxWidth > clientWidth ? clientWidth - 30 : opts._maxWidth;\n\t\t\t}\n\t\t\tif (newWidth) {\n\t\t\t\tlet chart  = this._chart;\n\t\t\t\topts.width = newWidth;\n\t\t\t\tif (chart && chart._chart) {\n\t\t\t\t\tchart._chart._resize(opts);\n\t\t\t\t\topts.xTicks = this._xTicks();\n\t\t\t\t\topts.yTicks = this._yTicks();\n\t\t\t\t\tthis._updateChart();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._updateMapSegments();\n\t},\n\n\t/**\n\t * Handles the drag event over the ruler filter.\n\t */\n\t_rulerFilterHandler: function(e) {\n\t\tthis._updateMapSegments(e.coords);\n\t},\n\n\t/**\n\t * Collapse or Expand current chart control.\n\t */\n\t_toggle: function() {\n\t\tif (_.hasClass(this._container, \"elevation-expanded\"))\n\t\t\tthis._collapse();\n\t\telse\n\t\t\tthis._expand();\n\t},\n\n\t/**\n\t * Sets the view of the map (center and zoom). Useful when \"followMarker\" is true.\n\t */\n\t_setMapView: function(item) {\n\t\tif (!this.options.followMarker || !this._map) return;\n\t\tlet zoom = this._map.getZoom();\n\t\tif (\"number\" === typeof this._zFollow) {\n\t\t\tif (zoom < this._zFollow) zoom = this._zFollow;\n\t\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\n\t\t} else if (!this._map.getBounds().contains(item.latlng)) {\n\t\t\tthis._map.setView(item.latlng, zoom, { animate: true, duration: 0.25 });\n\t\t}\n\t},\n\n\t/**\n\t * Toggle chart data on legend click\n\t */\n\t_toggleChartHandler: function(e) {\n\t\tlet { path, name, enabled } = e;\n\n\t\tthis._chartEnabled = this._chart._hasActiveLayers();\n\n\t\t// toggle layer visibility on empty chart\n\t\tthis._layers.eachLayer(layer => {\n\t\t\tlet node = layer.getElement && layer.getElement();\n\t\t\t_.toggleClass(node, this.options.polyline.className + ' ' + this.options.theme, this._chartEnabled);\n\t\t\t}\n\t\t);\n\n\t\t// toggle option value (eg. altitude = { 'disabled' || 'disabled' })\n\t\tthis.options[name] = !enabled && this.options[name] == 'disabled' ? 'enabled' : 'disabled';\n\n\t\t// remove marker on empty chart\n\t\tif (!this._chartEnabled) {\n\t\t\tthis._chart._hideDiagramIndicator();\n\t\t\tthis._marker.remove();\n\t\t}\n\t},\n\n\t/**\n\t * Calculates [x, y] domain and then update chart.\n\t */\n\t_updateChart: function() {\n\t\tif (!this._data.length || !this._container) return;\n\n\t\tthis._fireEvt(\"elechart_axis\");\n\t\tthis._fireEvt(\"elechart_area\");\n\n\t\tthis._chart.update({ data: this._data, options: this.options });\n\n\t\tthis._x     = this._chart._x;\n\t\tthis._y     = this._chart._y;\n\n\t\tthis._fireEvt('elechart_updated');\n\t},\n\n\t/*\n\t * Update the position/height indicator marker drawn onto the map\n\t */\n\t_updateMarker: function(item) {\n\t\tif (!this._marker) return;\n\t\tthis._marker.update({\n\t\t\tmap         : this._map,\n\t\t\titem        : item,\n\t\t\tmaxElevation: this.track_info.elevation_max || 0,\n\t\t\toptions     : this.options\n\t\t});\n\t},\n\n\t/**\n\t * Fix marker rotation on rotated maps\n\t */\n\t_rotateMarker: function() {\n\t\tif (!this._marker) return;\n\t\tthis._marker.update();\n\t},\n\n\t/**\n\t * Highlight track segments on the map.\n\t */\n\t_updateMapSegments: function(coords) {\n\t\tthis._markedSegments.setLatLngs(coords || []);\n\t\tif (coords && this._map && !this._map.hasLayer(this._markedSegments)) {\n\t\t\tthis._markedSegments.addTo(this._map);\n\t\t}\n\t},\n\n\t/**\n\t * Update chart summary.\n\t */\n\t_updateSummary: function() {\n\t\tthis._summary.reset();\n\n\t\tif (this.options.summary) {\n\t\t\tthis._fireEvt(\"elechart_summary\");\n\t\t}\n\t\tif (this.options.downloadLink && this._downloadURL) { // TODO: generate dynamically file content instead of using static file urls.\n\t\t\tthis.summaryDiv.innerHTML += '<span class=\"download\"><a href=\"#\">' + L._('Download') + '</a></span>'\n\t\t\t_.select('.download a', this.summaryDiv).onclick = (e) => {\n\t\t\t\te.preventDefault();\n\t\t\t\tthis._fireEvt('eletrack_download', { downloadLink: this.options.downloadLink, confirm: _.saveFile.bind(this, this._downloadURL) });\n\t\t\t};\n\t\t};\n\t},\n\n\n\t/**\n\t * Calculates chart width.\n\t */\n\t_width: function() {\n\t\tif (this._chart) return this._chart._width();\n\t\tlet opts = this.options;\n\t\treturn opts.width - opts.margins.left - opts.margins.right;\n\t},\n\n\t/**\n\t * Calculate chart xTicks\n\t */\n\t_xTicks: function() {\n\t\tif (this.__xTicks) this.__xTicks = this.options.xTicks;\n\t\treturn this.__xTicks || Math.round(this._width() / 75);\n\t},\n\n\t/**\n\t * Calculate chart yTicks\n\t */\n\t_yTicks: function() {\n\t\tif (this.__yTicks) this.__yTicks = this.options.yTicks;\n\t\treturn this.__yTicks || Math.round(this._height() / 30);\n\t}\n\n});\n\n/**\n * Attach here some useful elevation hooks.\n */\nElevation.addInitHook(function() {\n\n\tthis.on('waypoint_added', function(e) {\n\t\tlet p = e.point,\n\t\t\tpop = p._popup;\n\t\tif (pop) {\n\t\t\tpop.options.className = 'elevation-popup';\n\t\t}\n\t\tif (pop && pop._content) {\n\t\t\tpop._content = decodeURI(pop._content);\n\t\t\tp.bindTooltip(pop._content, { direction: 'auto', sticky: true, opacity: 1, className: 'elevation-tooltip' }).openTooltip();\n\t\t}\n\t});\n\n\tthis.on(\"eletrack_download\", function(e) {\n\t\tif (e.downloadLink == 'modal' && typeof CustomEvent === \"function\") {\n\t\t\tdocument.dispatchEvent(new CustomEvent(\"eletrack_download\", { detail: e }));\n\t\t} else if (e.downloadLink == 'link' || e.downloadLink === true) {\n\t\t\te.confirm();\n\t\t}\n\t});\n\n\tthis.on('eledata_loaded', function(e) {\n\t\tlet map   = this._map;\n\t\tlet layer = e.layer;\n\t\tif (!map) {\n\t\t\tconsole.warn(\"Undefined elevation map object\");\n\t\t\treturn;\n\t\t}\n\t\tmap.once('layeradd',   (e) => this.options.autofitBounds && this.fitBounds(layer.getBounds()));\n\n\t\tif (L.Browser.mobile) {\n\n\t\t\tif (this.options.polyline) layer.addTo(map);\n\n\t\t} else {\n\n\t\t\t// leaflet-geometryutil\n\t\t\tElevation._geomutilLazyLoader = _.lazyLoader(\n\t\t\t\tthis.__LGEOMUTIL,\n\t\t\t\ttypeof L.GeometryUtil !== 'function' || !this.options.lazyLoadJS,\n\t\t\t\tElevation._geomutilLazyLoader\n\t\t\t).then(\n\t\t\t\t() => {\n\n\t\t\t\t\t// leaflet-almostover\n\t\t\t\t\tif (this.options.almostOver) {\n\t\t\t\t\t\tElevation._almostoverLazyLoader = _.lazyLoader(\n\t\t\t\t\t\t\tthis.__LALMOSTOVER,\n\t\t\t\t\t\t\ttypeof L.Handler.AlmostOver  !== 'function' || !this.options.lazyLoadJS,\n\t\t\t\t\t\t\tElevation._almostoverLazyLoader\n\t\t\t\t\t\t).then(\n\t\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\t\tmap.addHandler('almostOver',L.Handler.AlmostOver)\n\t\t\t\t\t\t\t\tif (L.GeometryUtil && map.almostOver && map.almostOver.enabled()) {\n\t\t\t\t\t\t\t\t\tmap.almostOver.addLayer(layer);\n\t\t\t\t\t\t\t\t\tmap\n\t\t\t\t\t\t\t\t\t\t.on('almost:move', (e) => this._mousemoveLayerHandler(e))\n\t\t\t\t\t\t\t\t\t\t.on('almost:out',  (e) => this._mouseoutHandler(e));\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// leaflet-distance-markers\n\t\t\t\t\tif (this.options.distanceMarkers) {\n\t\t\t\t\t\tElevation._distanceMarkersLazyLoader = _.lazyLoader(\n\t\t\t\t\t\t\tthis.__LDISTANCEM,\n\t\t\t\t\t\t\ttypeof L.DistanceMarkers  !== 'function' || !this.options.lazyLoadJS,\n\t\t\t\t\t\t\tElevation._distanceMarkersLazyLoader\n\t\t\t\t\t\t).then(() => this.options.polyline && layer.addTo(map));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (this.options.polyline) layer.addTo(map);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t);\n\t\t}\n\t});\n\n\t// Basic canvas renderer support.\n\tlet oldProto = L.Canvas.prototype._fillStroke;\n\tlet control  = this;\n\tL.Canvas.include({\n\t\t_fillStroke: function(ctx, layer) {\n\t\t\tif (control._layers.hasLayer(layer)) {\n\n\t\t\t\tlet theme      = control.options.theme.replace('-theme', '');\n\t\t\t\tlet color      = D3.Colors[theme] || {};\n\t\t\t\tlet options    = layer.options;\n\n\t\t\t\toptions.color  = color.line || color.area || theme;\n\t\t\t\toptions.stroke = !!options.color;\n\n\t\t\t\toldProto.call(this, ctx, layer);\n\n\t\t\t\tif (options.stroke && options.weight !== 0) {\n\t\t\t\t\tlet oldVal                   = ctx.globalCompositeOperation || 'source-over';\n\t\t\t\t\tctx.globalCompositeOperation = 'destination-over'\n\t\t\t\t\tctx.strokeStyle              = '#FFF';\n\t\t\t\t\tctx.lineWidth                = options.weight * 1.75;\n\t\t\t\t\tctx.stroke();\n\t\t\t\t\tctx.globalCompositeOperation = oldVal;\n\t\t\t\t}\n\n\t\t\t} else {\n\t\t\t\toldProto.call(this, ctx, layer);\n\t\t\t}\n\t\t}\n\t});\n\n\t// Partially fix: https://github.com/Raruto/leaflet-elevation/issues/81#issuecomment-713477050\n\tthis.on('elechart_init', function() {\n\t\tthis.once('elechart_change elechart_hover', function(e) {\n\t\t\tif (this._chartEnabled) {\n\t\t\t\tthis._chart._showDiagramIndicator(e.data, e.xCoord);\n\t\t\t\tthis._chart._showDiagramIndicator(e.data, e.xCoord);\n\t\t\t}\n\t\t\tthis._updateMarker(e.data);\n\t\t});\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts     = this.options;\n\tlet distance = {};\n\n\tif (this.options.imperial) {\n\t\tthis._distanceFactor = this.__mileFactor;\n\t\tthis._xLabel         = \"mi\";\n\t} else {\n\t\tthis._distanceFactor = opts.distanceFactor;\n\t\tthis._xLabel         = opts.xLabel;\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data = this._data;\n\t\tlet i    = e.index;\n\n\t\tlet track = this.track_info;\n\t\tlet dist  = track.distance || 0;\n\n\t\tlet curr = data[i].latlng;\n\t\tlet prev = i > 0 ? data[i - 1].latlng : curr;\n\n\t\tlet delta = curr.distanceTo(prev) * this._distanceFactor;\n\n\t\tdist += Math.round(delta / 1000 * 100000) / 100000; // handles floating points calc\n\n\t\tdata[i].dist = dist;\n\n\t\ttrack.distance = dist;\n\t});\n\n\tthis.on(\"elechart_axis\", function() {\n\n\t\tthis._chart._registerAxisGrid({\n\t\t\taxis      : \"x\",\n\t\t\tposition  : \"bottom\",\n\t\t\tscale     : this._chart._x,\n\t\t});\n\n\t});\n\n\tif (this.options.distance != \"summary\") {\n\n\t\tthis.on(\"elechart_axis\", function() {\n\n\t\t\tdistance.x     = this._chart._x;\n\t\t\tdistance.label = this._chart._xLabel;\n\n\t\t\tthis._chart._registerAxisScale({\n\t\t\t\taxis    : \"x\",\n\t\t\t\tposition: \"bottom\",\n\t\t\t\tscale   : distance.x,\n\t\t\t\tlabel   : distance.label,\n\t\t\t\tlabelY  : 25,\n\t\t\t\tlabelX  : () => this._width() + 6,\n\t\t\t\tname    : \"distance\",\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tthis._registerSummary({\n\t\t\"totlen\"  : {\n\t\t\tlabel: \"Total Length: \",\n\t\t\tvalue: (track) => (track.distance || 0).toFixed(2) + '&nbsp;' + this._xLabel\n\t\t}\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts     = this.options;\n\tlet altitude = {};\n\n\tif (opts.imperial) {\n\t\tthis._heightFactor = this.__footFactor;\n\t\tthis._yLabel       = \"ft\";\n\t} else {\n\t\tthis._heightFactor = opts.heightFactor;\n\t\tthis._yLabel       = opts.yLabel;\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data   = this._data;\n\t\tlet i      = e.index;\n\t\tlet z      = data[i].z * this._heightFactor;\n\n\t\tlet track  = this.track_info;\n\t\tlet eleMax = track.elevation_max || -Infinity;\n\t\tlet eleMin = track.elevation_min || +Infinity;\n\n\t\t// check and fix missing elevation data on last added point\n\t\tif (!this.options.skipNullZCoords && i > 0) {\n\t\t\tlet prevZ = data[i - 1].z;\n\t\t\tif (isNaN(prevZ)) {\n\t\t\t\tlet lastZ = this._lastValidZ;\n\t\t\t\tlet currZ = z;\n\t\t\t\tif (!isNaN(lastZ) && !isNaN(currZ)) {\n\t\t\t\t\tprevZ   = (lastZ + currZ) / 2;\n\t\t\t\t} else if (!isNaN(lastZ)) {\n\t\t\t\t\tprevZ   = lastZ;\n\t\t\t\t} else if (!isNaN(currZ)) {\n\t\t\t\t\tprevZ   = currZ;\n\t\t\t\t}\n\t\t\t\tif (!isNaN(prevZ)) return data.splice(i - 1, 1);\n\t\t\t\tdata[i - 1].z = prevZ;\n\t\t\t}\n\t\t}\n\t\t// skip point if it has not elevation\n\t\tif (!isNaN(z)) {\n\t\t\teleMax = eleMax < z ? z : eleMax;\n\t\t\teleMin = eleMin > z ? z : eleMin;\n\t\t\tthis._lastValidZ = z;\n\t\t}\n\n\t\tdata[i].z = z;\n\n\t\ttrack.elevation_max = eleMax;\n\t\ttrack.elevation_min = eleMin;\n\t});\n\n\tthis.on(\"elechart_axis\", function() {\n\n\t\tthis._chart._registerAxisGrid({\n\t\t\taxis      : \"y\",\n\t\t\tposition  : \"left\",\n\t\t\tscale     : this._chart._y,\n\t\t});\n\n\t});\n\n\tif (this.options.altitude != \"summary\") {\n\n\t\tthis.on(\"elechart_axis\", function() {\n\n\t\t\taltitude.y     = this._chart._y;\n\t\t\taltitude.label = this._yLabel;\n\n\t\t\tthis._chart._registerAxisScale({\n\t\t\t\taxis    : \"y\",\n\t\t\t\tposition: \"left\",\n\t\t\t\tscale   : altitude.y,\n\t\t\t\tlabel   : altitude.label,\n\t\t\t\tlabelX  : -3,\n\t\t\t\tlabelY  : -8,\n\t\t\t\tname    : \"altitude\",\n\t\t\t});\n\n\t\t});\n\n\t\tthis.on(\"elechart_init\", function() {\n\n\t\t\tlet theme      = this.options.theme.replace('-theme', '');\n\t\t\tlet color      = D3.Colors[theme] || {};\n\t\t\tlet alpha      = (this.options.detached ? (color.alpha || '0.8') : 1);\n\t\t\tlet stroke     = (this.options.detached ? color.stroke : false);\n\n\t\t\tthis._chart._registerAreaPath({\n\t\t\t\tname         : 'altitude',\n\t\t\t\tlabel        : 'Altitude',\n\t\t\t\tscaleX       : 'distance',\n\t\t\t\tscaleY       : 'altitude',\n\t\t\t\tcolor        : color.area || theme,\n\t\t\t\tstrokeColor  : stroke || '#000',\n\t\t\t\tstrokeOpacity: \"1\",\n\t\t\t\tfillOpacity  : alpha,\n\t\t\t\tpreferCanvas : this.options.preferCanvas,\n\t\t\t});\n\n\t\t});\n\n\t}\n\n\tthis._registerSummary({\n\t\t\"maxele\"  : {\n\t\t\tlabel: \"Max Elevation: \",\n\t\t\tvalue: (track) => (track.elevation_max || 0).toFixed(2) + '&nbsp;' + this._yLabel\n\t\t},\n\t\t\"minele\"  : {\n\t\t\tlabel: \"Min Elevation: \",\n\t\t\tvalue: (track) => (track.elevation_min || 0).toFixed(2) + '&nbsp;' + this._yLabel\n\t\t},\n\t});\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tlet opts = this.options;\n\tlet time = {};\n\n\ttime.label       = opts.timeLabel  || 't';\n\tthis._timeFactor = opts.timeFactor;\n\n\t/**\n\t * Common AVG speeds:\n\t * ----------------------\n\t *  slow walk = 1.8  km/h\n\t *  walking   = 3.6  km/h\n\t *  running   = 10.8 km/h\n\t *  cycling   = 18   km/h\n\t *  driving   = 72   km/h\n\t * ----------------------\n\t */\n\tthis._timeAVGSpeed = (opts.timeAVGSpeed || 3.6) * (opts.speedFactor || 1);\n\n\tif (!opts.timeFormat) {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleString().replaceAll('/', '-').replaceAll(',', ' ');\n\t} else if (opts.timeFormat == 'time') {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleTimeString();\n\t} else if (opts.timeFormat == 'date') {\n\t\topts.timeFormat = (time) => (new Date(time)).toLocaleDateString();\n\t}\n\n\topts.xTimeFormat = opts.xTimeFormat || ((t) => _.formatTime(t).split(\"'\")[0]);\n\n\tif (opts.time && opts.time != \"summary\" && !L.Browser.mobile) {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"x\",\n\t\t\tposition   : \"top\",\n\t\t\tscale      : {\n\t\t\t\tattr       : \"duration\",\n\t\t\t\tmin        : 0,\n\t\t\t},\n\t\t\tlabel      : time.label,\n\t\t\tlabelY     : -10,\n\t\t\tlabelX     : () => this._width(),\n\t\t\tname       : \"time\",\n\t\t\ttickFormat : (d)  => (d == 0 ? '' : opts.xTimeFormat(d)),\n\t\t\tonAxisMount: axis => {\n\t\t\t\taxis.select(\".domain\")\n\t\t\t\t\t.remove();\n\t\t\t\taxis.selectAll(\"text\")\n\t\t\t\t\t.attr('opacity', 0.65)\n\t\t\t\t\t.style('font-family', 'Monospace')\n\t\t\t\t\t.style('font-size', '110%');\n\t\t\t\taxis.selectAll(\".tick line\")\n\t\t\t\t\t.attr('y2', this._height())\n\t\t\t\t\t.attr('stroke-dasharray', 2)\n\t\t\t\t\t.attr('opacity', 0.75);\n\t\t\t\t}\n\t\t});\n\n\t}\n\n\tthis.on('elepoint_added', function(e) {\n\t\tlet data = this._data;\n\t\tlet i    = e.index;\n\n\t\t// Add missing timestamps (see: options.timeAVGSpeed)\n\t\tif (!e.point.meta || !e.point.meta.time) {\n\t\t\te.point.meta = e.point.meta || {};\n\t\t\tlet delta = (data[i].dist - data[i > 0 ? i - 1 : i].dist);\n\t\t\tlet speed = this._timeAVGSpeed;\n\t\t\te.point.meta.time = new Date(\n\t\t\t\t(\n\t\t\t\t\ti > 0\n\t\t\t\t\t\t? data[i - 1].time.getTime() + ((( delta / speed) * this._timeFactor) * 1000)\n\t\t\t\t\t\t: Date.now()\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\n\t\tlet time = e.point.meta.time;\n\n\t\t// Handle timezone offset\n\t\tif (time.getTime() - time.getTimezoneOffset() * 60 * 1000 === 0) {\n\t\t\ttime = 0;\n\t\t}\n\n\t\tlet currT    = time;\n\t\tlet prevT    = i > 0 ? data[i - 1].time : currT;\n\n\t\tlet deltaT   = Math.abs(currT - prevT);\n\t\tlet duration = (this.track_info.time || 0) + deltaT;\n\n\t\tdata[i].time         = time;\n\t\tdata[i].duration     = duration;\n\n\t\tthis.track_info.time = duration;\n\t});\n\n\tif (this.options.time) {\n\n\t\tthis._registerFocusLabel({\n\t\t\tname: 'time',\n\t\t\tchart: (item) => this.options.timeFormat(item.time)\n\t\t});\n\n\t\tthis._registerSummary({\n\t\t\t\"tottime\"  : {\n\t\t\t\tlabel: \"Total Time: \",\n\t\t\t\tvalue: (track) => _.formatTime(track.time || 0)\n\t\t\t}\n\t\t});\n\n\t}\n\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.slope) return;\n\n\tlet opts  = this.options;\n\tlet slope = {};\n\n\tslope.label          = opts.slopeLabel || '%';\n\n\tif (this.options.slope != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"y\",\n\t\t\tposition   : \"right\",\n\t\t\tscale      : {\n\t\t\t\tmin        : -1,\n\t\t\t\tmax        : +1,\n\t\t\t},\n\t\t\ttickPadding: 16,\n\t\t\tlabel      : slope.label,\n\t\t\tlabelX     : 25,\n\t\t\tlabelY     : -8,\n\t\t\tname       : 'slope'\n\t\t});\n\n\t\tthis._registerAreaPath({\n\t\t\tname         : 'slope',\n\t\t\tlabel        : 'Slope',\n\t\t\tyAttr        : 'slope',\n\t\t\tscaleX       : 'distance',\n\t\t\tscaleY       : 'slope',\n\t\t\tcolor        : '#F00',\n\t\t\tstrokeColor  : '#000',\n\t\t\tstrokeOpacity: \"0.5\",\n\t\t\tfillOpacity  : \"0.25\",\n\t\t});\n\n\t}\n\n\tthis.on(\"eledata_updated\", function(e) {\n\t\tlet data  = this._data;\n\t\tlet i     = e.index;\n\t\tlet z     = data[i].z;\n\t\tlet delta = (data[i].dist - data[i > 0 ? i - 1 : i].dist) * 1000;\n\n\t\t// Slope / Gain\n\t\tlet track = this.track_info;\n\t\tlet tAsc  = track.ascent    || 0; // Total Ascent\n\t\tlet tDes  = track.descent   || 0; // Total Descent\n\t\tlet sMax  = track.slope_max || 0; // Slope Max\n\t\tlet sMin  = track.slope_min || 0; // Slope Min\n\t\tlet slope = 0;\n\n\t\tif (!isNaN(z)) {\n\t\t\tlet deltaZ  = i > 0 ? z - data[i - 1].z : 0;\n\t\t\tif (deltaZ > 0)      tAsc += deltaZ;\n\t\t\telse if (deltaZ < 0) tDes -= deltaZ;\n\t\t\t// slope in % = ( height / length ) * 100\n\t\t\tif (delta !== 0)     slope = (deltaZ / delta) * 100;\n\t\t}\n\n\t\t// Try to smooth \"crazy\" slope values.\n\t\tif (this.options.sDeltaMax) {\n\t\t\tlet deltaS    = i > 0 ? slope - data[i - 1].slope : 0;\n\t\t\tlet maxDeltaS = this.options.sDeltaMax;\n\t\t\tif (Math.abs(deltaS) > maxDeltaS) {\n\t\t\t\tslope       = data[i - 1].slope + maxDeltaS * Math.sign(deltaS);\n\t\t\t}\n\t\t}\n\n\t\t// Range of acceptable slope values.\n\t\tif (this.options.sRange) {\n\t\t\tlet range = this.options.sRange;\n\t\t\tif (slope < range[0])      slope = range[0];\n\t\t\telse if (slope > range[1]) slope = range[1];\n\t\t}\n\n\t\tslope = L.Util.formatNum(slope, 2);\n\n\t\tif (slope > sMax) sMax = slope;\n\t\tif (slope < sMin) sMin = slope;\n\n\t\tdata[i].slope   = slope;\n\n\t\ttrack.ascent    = tAsc;\n\t\ttrack.descent   = tDes;\n\t\ttrack.slope_max = sMax;\n\t\ttrack.slope_min = sMin;\n\t});\n\n\tthis._registerFocusLabel({\n\t\tname: 'slope',\n\t\tchart: (item) => item.slope + slope.label,\n\t\tmarker: (item) => Math.round(item.slope) + slope.label\n\t});\n\n\tthis._registerSummary({\n\t\t\"ascent\"  : {\n\t\t\tlabel: \"Total Ascent: \",\n\t\t\tvalue: (track) => Math.round(track.ascent || 0) + '&nbsp;' + this._yLabel\n\t\t},\n\t\t\"descent\"  : {\n\t\t\tlabel: \"Total Descent: \",\n\t\t\tvalue: (track) => Math.round(track.descent || 0) + '&nbsp;' + this._yLabel\n\t\t},\n\t\t\"minslope\": {\n\t\t\tlabel: \"Min Slope: \",\n\t\t\tvalue: (track) => Math.round(track.slope_min || 0) + '&nbsp;' + slope.label\n\t\t},\n\t\t\"maxslope\": {\n\t\t\tlabel: \"Max Slope: \",\n\t\t\tvalue: (track) => Math.round(track.slope_max || 0) + '&nbsp;' + slope.label\n\t\t}\n\t});\n\n\n});\n","import \"leaflet-i18n\";\nimport * as _ from \"./utils\";\nimport * as D3 from \"./components\";\nimport { Elevation } from \"./control\";\n\nElevation.addInitHook(function () {\n  if (!this.options.speed && !this.options.acceleration) return;\n\n  let opts = this.options;\n  let speed = {};\n\n  speed.label = opts.speedLabel || L._(this.options.imperial ? \"mph\" : \"km/h\");\n  this._speedFactor = opts.speedFactor || 1;\n\n  if (this.options.speed && this.options.speed != \"summary\") {\n    this._registerAxisScale({\n      axis: \"y\",\n      position: \"right\",\n      scale: {\n        min: 0,\n        max: +1,\n      },\n      tickPadding: 16,\n      label: speed.label,\n      labelX: 25,\n      labelY: -8,\n      name: \"speed\",\n    });\n\n    this._registerAreaPath({\n      name: \"speed\",\n      label: \"Speed\",\n      yAttr: \"speed\",\n      scaleX: \"distance\",\n      scaleY: \"speed\",\n      color: \"#03ffff\",\n      strokeColor: \"#000\",\n      strokeOpacity: \"0.5\",\n      fillOpacity: \"0.25\",\n    });\n  }\n\n  this.on(\"elepoint_added\", function (e) {\n    let data = this._data;\n    let i = e.index;\n\n    let currT = data[i].time;\n    let prevT = i > 0 ? data[i - 1].time : currT;\n\n    let deltaT = currT - prevT;\n\n    let track = this.track_info;\n    let sMax = track.speed_max || -Infinity; // Speed Max\n    let sMin = track.speed_min || +Infinity; // Speed Min\n    let sAvg = track.speed_avg || 0; // Speed Avg\n    let speed = 0;\n\n    if (e.point.meta && e.point.meta.speed) speed = e.point.meta.speed;\n    else if (deltaT > 0) {\n      let delta = (data[i].dist - data[i > 0 ? i - 1 : i].dist) * 1000;\n      speed = Math.abs((delta / deltaT) * this._timeFactor) * this._speedFactor;\n\n      // Try to smooth \"crazy\" speed values.\n      if (this.options.speedDeltaMax) {\n        let deltaS = i > 0 ? speed - data[i - 1].speed : 0;\n        let maxDeltaS = this.options.speedDeltaMax;\n        if (Math.abs(deltaS) > maxDeltaS) {\n          speed = data[i - 1].speed + maxDeltaS * Math.sign(deltaS);\n        }\n      }\n\n      // Range of acceptable speed values.\n      if (this.options.speedRange) {\n        let range = this.options.speedRange;\n        if (speed < range[0]) speed = range[0];\n        else if (speed > range[1]) speed = range[1];\n      }\n    }\n\n    speed = L.Util.formatNum(speed, 2);\n\n    sMax = speed > sMax ? speed : sMax;\n    sMin = speed < sMin ? speed : sMin;\n    sAvg = (speed + sAvg) / 2.0;\n\n    data[i].speed = speed;\n\n    track.speed_max = sMax;\n    track.speed_min = sMin;\n    track.speed_avg = sAvg;\n  });\n\n  if (this.options.speed) {\n    this._registerFocusLabel({\n      name: \"speed\",\n      chart: (item) => item.speed + \" \" + speed.label,\n      marker: (item) => Math.round(item.speed) + \" \" + speed.label,\n    });\n\n    this._registerSummary({\n      minspeed: {\n        label: \"Min Speed: \",\n        value: (track) =>\n          Math.round(track.speed_min || 0) + \"&nbsp;\" + speed.label,\n      },\n      maxspeed: {\n        label: \"Max Speed: \",\n        value: (track) =>\n          Math.round(track.speed_max || 0) + \"&nbsp;\" + speed.label,\n      },\n      avgspeed: {\n        label: \"Avg Speed: \",\n        value: (track) =>\n          Math.round(track.speed_avg || 0) + \"&nbsp;\" + speed.label,\n      },\n    });\n  }\n});\n","import 'leaflet-i18n';\nimport * as _        from './utils';\nimport * as D3       from './components';\nimport { Elevation } from './control';\n\nElevation.addInitHook(function() {\n\n\tif (!this.options.acceleration) return;\n\n\tlet opts = this.options;\n\tlet acceleration = {};\n\n\tacceleration.label       = opts.accelerationLabel  || L._(this.options.imperial ? 'ft/s' : 'm/s');\n\tthis._accelerationFactor = opts.accelerationFactor || 1;\n\n\tif (this.options.acceleration != \"summary\") {\n\n\t\tthis._registerAxisScale({\n\t\t\taxis       : \"y\",\n\t\t\tposition   : \"right\",\n\t\t\tscale      : {\n\t\t\t\tmin        : 0,\n\t\t\t\tmax        : +1,\n\t\t\t},\n\t\t\ttickPadding: 16,\n\t\t\tlabel      : acceleration.label,\n\t\t\tlabelX     : 25,\n\t\t\tlabelY     : -8,\n\t\t\tname       : 'acceleration'\n\t\t});\n\n\t\tthis._registerAreaPath({\n\t\t\tname       : 'acceleration',\n\t\t\tlabel      : 'Acceleration',\n\t\t\tyAttr      : 'acceleration',\n\t\t\tscaleX     : 'distance',\n\t\t\tscaleY     : 'acceleration',\n\t\t\tcolor      : '#050402',\n\t\t\tstrokeColor  : '#000',\n\t\t\tstrokeOpacity: \"0.5\",\n\t\t\tfillOpacity  : \"0.25\",\n\t\t});\n\n\t}\n\n\tthis.on('elepoint_added', function(e) {\n\t\tlet data   = this._data;\n\t\tlet i      = e.index;\n\n\t\tlet currT  = data[i].time;\n\t\tlet prevT  = i > 0 ? data[i - 1].time : currT;\n\n\t\tlet deltaT = (currT - prevT) / 1000;\n\n\t\tlet track  = this.track_info;\n\t\tlet sMax   = track.acceleration_max || -Infinity; // Acceleration Max\n\t\tlet sMin   = track.acceleration_min || +Infinity; // Acceleration Min\n\t\tlet sAvg   = track.acceleration_avg || 0; // Acceleration Avg\n\t\tlet acceleration = 0;\n\n\t\tif (deltaT > 0) {\n\t\t\tlet curr     = data[i].speed;\n\t\t\tlet prev     = i > 0 ? data[i - 1].speed : curr;\n\t\t\tlet delta    = (curr - prev) * (1000 / this._timeFactor);\n\t\t\tacceleration = Math.abs((delta / deltaT)) * this._accelerationFactor;\n\t\t}\n\n\t\t// Try to smooth \"crazy\" acceleration values.\n\t\tif (this.options.accelerationDeltaMax) {\n\t\t\tlet deltaA     = i > 0 ? acceleration - data[i - 1].acceleration : 0;\n\t\t\tlet maxDeltaS  = this.options.accelerationDeltaMax;\n\t\t\tif (Math.abs(deltaA) > maxDeltaS) {\n\t\t\t\tacceleration = data[i - 1].acceleration + maxDeltaS * Math.sign(deltaA);\n\t\t\t}\n\t\t}\n\n\t\t// Range of acceptable acceleration values.\n\t\tif (this.options.accelerationRange) {\n\t\t\tlet range = this.options.accelerationRange;\n\t\t\tif (acceleration < range[0])      acceleration = range[0];\n\t\t\telse if (acceleration > range[1]) acceleration = range[1];\n\t\t}\n\n\t\tacceleration = L.Util.formatNum(acceleration, 2);\n\n\t\tif (acceleration > sMax) sMax = acceleration;\n\t\tif (acceleration < sMin) sMin = acceleration;\n\t\tsAvg = (acceleration + sAvg) / 2.0;\n\n\t\tdata[i].acceleration = acceleration;\n\n\t\ttrack.acceleration_max = sMax;\n\t\ttrack.acceleration_min = sMin;\n\t\ttrack.acceleration_avg = sAvg;\n\t});\n\n\tthis._registerFocusLabel({\n\t\tname  : 'acceleration',\n\t\tchart : (item) => item.acceleration + \" \" + acceleration.label,\n\t\tmarker: (item) => Math.round(item.acceleration) + \" \" + acceleration.label,\n\t});\n\n\tthis._registerSummary({\n\t\t\"minacceleration\"  : {\n\t\t\tlabel: \"Min Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_min || 0) + '&nbsp;' + acceleration.label\n\t\t},\n\t\t\"maxacceleration\"  : {\n\t\t\tlabel: \"Max Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_max || 0) + '&nbsp;' + acceleration.label\n\t\t},\n\t\t\"avgacceleration\": {\n\t\t\tlabel: \"Avg Acceleration: \",\n\t\t\tvalue: (track) => Math.round(track.acceleration_avg || 0) + '&nbsp;' + acceleration.label\n\t\t}\n\t});\n\n});\n","/*\n * Copyright (c) 2019, GPL-3.0+ Project, Raruto\n *\n *  This file is free software: you may copy, redistribute and/or modify it\n *  under the terms of the GNU General Public License as published by the\n *  Free Software Foundation, either version 2 of the License, or (at your\n *  option) any later version.\n *\n *  This file is distributed in the hope that it will be useful, but\n *  WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n *  General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see .\n *\n * This file incorporates work covered by the following copyright and\n * permission notice:\n *\n *     Copyright (c) 2013-2016, MIT License, Felix MrMufflon Bache\n *\n *     Permission to use, copy, modify, and/or distribute this software\n *     for any purpose with or without fee is hereby granted, provided\n *     that the above copyright notice and this permission notice appear\n *     in all copies.\n *\n *     THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL\n *     WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED\n *     WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE\n *     AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR\n *     CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS\n *     OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,\n *     NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN\n *     CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\n */\n\nimport 'leaflet-i18n';\nimport * as _ from './utils';\nimport * as D3 from './components';\nimport { Chart } from './chart';\nimport { Elevation } from './control';\nimport './distance';\nimport './altitude';\nimport './time';\nimport './slope';\nimport './speed';\nimport './acceleration';\n\nElevation.Utils = _;\nElevation.Components = D3;\nElevation.Chart = Chart;\n\nL.control.elevation = (options) => new Elevation(options);\n"],"names":["factory","window","define","amd","exports","module","require","L","locales","locale","registerLocale","code","Util","extend","setLocale","i18n","_","translate","string","data","template","err","deepMerge","target","sources","length","source","shift","isObject","key","Object","assign","deferFunc","f","document","readyState","addEventListener","once","debounce","func","wait","context","immediate","timeout","args","arguments","clearTimeout","setTimeout","apply","SEC","MIN","HOUR","DAY","formatTime","t","d","Math","floor","h","m","s","round","toString","padStart","GeoJSONLoader","control","JSON","parse","distanceMarkers","options","lazy","wptIcons","gpxOptions","marker_options","layer","geoJson","style","feature","polyline","theme","className","pointToLayer","latlng","waypoints","prop","properties","desc","name","sym","replace","toLowerCase","divIcon","html","iconSize","iconAnchor","marker","icon","bindPopup","openPopup","_registerCheckPoint","label","fire","point","element","onEachFeature","geometry","type","_latlngs","forEach","i","meta","time","ele","hr","cad","atemp","speed","alt","speeds","Date","coordTimes","times","parseInt","heartRates","heartRate","addData","on","e","path","DistanceMarkers","Polyline","track_info","Control","Elevation","_d3LazyLoader","then","_fireEvt","isDomVisible","elem","offsetWidth","offsetHeight","getClientRects","item","Array","isArray","isVisible","styles","getComputedStyle","isVisibleByStyles","visibility","display","isAboveOtherElements","boundingRect","getBoundingClientRect","left","right","top","bottom","above","pointerEvents","elementFromPoint","isJSONDoc","doc","trim","indexOf","console","warn","isXMLDoc","documentElement","ownerDocument","nodeName","lazyLoader","url","skip","loader","Promise","resolve","reject","tag","createElement","src","head","appendChild","saveFile","dataURI","fileName","a","create","href","download","b","body","click","removeChild","waitHolder","ticking","scrollFn","requestAnimFrame","removeEventListener","addClass","targetNode","split","every","DomUtil","removeClass","toggleClass","conditional","call","replaceClass","removeClassName","addClassName","value","getStyle","setProperty","toggleStyle","toggleEvent","leafletElement","eventName","handler","tagName","attributes","parent","setAttributes","append","child","insert","position","insertAdjacentElement","attrs","k","setAttribute","select","selector","querySelector","DomEvent","off","hasClass","randomId","random","substr","each","obj","fn","Colors","area","alpha","stroke","line","Area","width","height","xAttr","yAttr","scaleX","scaleY","interpolation","d3","curve","x","xDiagCoord","y0","y1","Path","color","strokeColor","strokeOpacity","fillOpacity","classed","attr","Axis","tickSize","tickPadding","axis","scale","ticks","tickFormat","labelX","labelY","onAxisMount","g","w","axisScale","l","toUpperCase","axisGroup","join","text","Grid","props","HeightFocusLine","xCoord","yCoord","HeightFocusLabel","y","node","selectAll","HeightFocusMarker","circle","LegendItem","margins","svg","ownerSVGElement","dispatch","detail","legend","enabled","MouseFocusLine","MouseFocusLabel","rect","xAlign","yAlign","bbox","getBBox","max","Browser","webkit","Infinity","Ruler","symbol","symbolTriangle","exit","remove","enter","merge","size","angle","Domain","min","forceBounds","domain","extent","Range","Scale","range","scaleLinear","Bisect","bisector","invert","Chart","ruler","_width","_height","panes","grid","brush","tooltip","clipPath","clipRect","foreignObject","canvas","getContext","dragG","focusG","brushG","brushX","opts","utils","chart","_resize","pane","get","Class","includes","Evented","prototype","Mixin","Events","initialize","_data","_props","scales","paths","areas","grids","axes","legendItems","focusLabels","_scales","_domains","_ranges","_paths","_brushEnabled","dragging","_zoomEnabled","zooming","imperial","_xLabel","_yLabel","xLabel","yLabel","_chart","D3","_container","_grid","_area","_point","_axis","_legend","_initScale","_clipPath","_canvas","_context","_dragG","_focusG","_brush","_focusline","_focuslabel","_zoom","zoom","_drag","drag","_initInteractions","update","_updateScale","_updateArea","_updateAxis","_updateLegend","_updateClipper","render","container","clear","_resetDrag","clearRect","_path","_drawPath","ctx","datum","preferCanvas","beginPath","moveTo","p","Path2D","strokeStyle","fillStyle","lineWidth","globalCompositeOperation","globalAlpha","fill","closePath","_hasActiveLayers","_initBrush","selection","start","_findIndexForXCoord","end","dragstart","dragend","focus","sourceEvent","coords","pointers","filter","shiftKey","button","bind","_initClipper","margin","onStart","transform","onEnd","onZoom","distance","_x","rescaleX","_hideDiagramIndicator","scaleExtent","translateExtent","buttons","_initRuler","_initLegend","formatNum","format","yMax","z","_y","_findCoordsForY","_registerAxisScale","xAxisMin","xAxisMax","yAxisMin","yAxisMax","altitude","_registerAreaPath","_registerAxisGrid","forceAxisBounds","xTicks","yTicks","_findIndexForLatLng","dist","isNaN","property","pos","y2","x2","_registerFocusLabel","gridOpts","axesOpts","n","substring","legends","items","nodes","v","map","sign","rev","slice","reverse","push","concat","xAxesB","marginB","marginR","tx","ty","r","list","reduce","array","index","next","curr","result","distanceTo","_resetZoom","zoomIdentity","_showDiagramIndicator","xCoordinate","yCoordinate","decimalsX","decimalsY","labels","Marker","_focusmarker","_marker","markerIcon","zIndexOffset","interactive","_focuslabels","addTo","_map","getPane","_latlng","latLngToLayerPoint","_rotate","rotatedPointToMapPanePoint","normalizedAlt","maxElevation","normalizedY","getElement","setLatLng","getLatLng","Summary","summary","reset","innerHTML","_registerSummary","Options","autofitBounds","autohide","mobile","autohideMarker","almostover","collapsed","detached","distanceFactor","downloadLink","elevationDiv","followMarker","async","startIconUrl","endIconUrl","shadowUrl","heightFactor","lazyLoadJS","loadData","defer","placeholder","opacity","weight","lineCap","polylineSegments","reverseCoords","skipNullZCoords","responsive","slope","sLimit","undefined","timeFactor","timeFormat","sDeltaMax","sInterpolation","sRange","zFollow","Mobile","__mileFactor","__footFactor","__D3","__TOGEOJSON","__LGEOMUTIL","__LALMOSTOVER","__LDISTANCEM","_addData","_addLayer","eleDiv","_initElevationDiv","isConnected","getContainer","onAdd","_layers","clearLayers","disableBrush","enableBrush","enableDragging","enableBrushing","disableDragging","disableBrushing","disableZoom","enableZoom","fitBounds","bounds","getBounds","isValid","latLngBounds","getZFollow","_zFollow","hide","featureGroup","_markedSegments","_chartEnabled","_setMapView","throttle","setStyle","colors","load","loadChart","loadDefer","loadLazy","loadXML","loadGeoJSON","loadFile","fetch","response","_downloadURL","catch","loadGPX","_togeojsonLazyLoader","toGeoJSON","xml","DOMParser","parseFromString","geojson","getElementsByTagName","pop","parentNode","_initButton","_initChart","_initSummary","_initMarker","_initLayer","_hideMarker","_resetView","_resizeChart","_rotateMarker","_updateChart","_updateSummary","onRemove","redraw","setZFollow","show","geom","_addGeoJSONData","coordinates","features","_addGPXData","_addPoint","lat","lng","latLng","addLayer","id","_collapse","_expand","_findItemForLatLng","_findItemForX","propagate","_xTicks","_yTicks","clientWidth","_maxWidth","maxWidth","_dragendHandler","_mousemoveHandler","_mouseoutHandler","_rulerFilterHandler","_toggleChartHandler","_mousemoveLayerHandler","_pane","createPane","zIndex","_renderer","disableClickPropagation","stopPropagation","_mousewheelHandler","link","_button","title","stop","_toggle","_summary","summaryDiv","_updateMarker","gestureHandling","_enabled","ll","getCenter","getZoom","deltaY","flyTo","_isFullscreen","newWidth","_updateMapSegments","setView","animate","duration","contains","eachLayer","elevation_max","setLatLngs","hasLayer","onclick","preventDefault","confirm","__xTicks","__yTicks","addInitHook","_popup","_content","decodeURI","bindTooltip","direction","sticky","openTooltip","CustomEvent","dispatchEvent","_geomutilLazyLoader","GeometryUtil","almostOver","_almostoverLazyLoader","Handler","AlmostOver","addHandler","_distanceMarkersLazyLoader","oldProto","Canvas","_fillStroke","include","oldVal","_distanceFactor","track","prev","delta","toFixed","_heightFactor","eleMax","eleMin","elevation_min","prevZ","lastZ","_lastValidZ","currZ","splice","timeLabel","_timeFactor","_timeAVGSpeed","timeAVGSpeed","speedFactor","toLocaleString","replaceAll","toLocaleTimeString","toLocaleDateString","xTimeFormat","getTime","now","getTimezoneOffset","currT","prevT","deltaT","abs","slopeLabel","tAsc","ascent","tDes","descent","sMax","slope_max","sMin","slope_min","deltaZ","deltaS","maxDeltaS","acceleration","speedLabel","_speedFactor","speed_max","speed_min","sAvg","speed_avg","speedDeltaMax","speedRange","minspeed","maxspeed","avgspeed","accelerationLabel","_accelerationFactor","accelerationFactor","acceleration_max","acceleration_min","acceleration_avg","accelerationDeltaMax","deltaA","accelerationRange","Utils","Components","elevation"],"mappings":"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"}